<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>XET: Content-Addressable Storage Protocol for Efficient Data Transfer</title>
<meta content="Frank Denis" name="author">
<meta content="
       This document specifies XET, a content-addressable storage (CAS) protocol designed for efficient storage and transfer of large files with chunk-level deduplication. 
       XET uses content-defined chunking to split files into variable-sized chunks, aggregates chunks into containers called xorbs, and enables deduplication across files and repositories through cryptographic hashing. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-denis-xet-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-denis-xet.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">XET</td>
<td class="right">December 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Denis</td>
<td class="center">Expires 18 June 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-denis-xet-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-12-15" class="published">15 December 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-06-18">18 June 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Denis</div>
<div class="org">Independent Contributor</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">XET: Content-Addressable Storage Protocol for Efficient Data Transfer</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies XET, a content-addressable storage (CAS) protocol designed for efficient storage and transfer of large files with chunk-level deduplication.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">XET uses content-defined chunking to split files into variable-sized chunks, aggregates chunks into containers called xorbs, and enables deduplication across files and repositories through cryptographic hashing.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/jedisct1/draft-denis-xet">https://github.com/jedisct1/draft-denis-xet</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 June 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-notational-conventions" class="internal xref">Notational Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-upload-flow" class="internal xref">Upload Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-download-flow" class="internal xref">Download Flow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-algorithm-suites" class="internal xref">Algorithm Suites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-suite-definition" class="internal xref">Suite Definition</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-suite-requirements" class="internal xref">Suite Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-suite-negotiation" class="internal xref">Suite Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-defined-suites" class="internal xref">Defined Suites</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-content-defined-chunking" class="internal xref">Content-Defined Chunking</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-gearhash-algorithm" class="internal xref">Gearhash Algorithm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-algorithm-parameters" class="internal xref">Algorithm Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-algorithm-description" class="internal xref">Algorithm Description</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-boundary-rules" class="internal xref">Boundary Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-determinism-requirements" class="internal xref">Determinism Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-performance-optimization" class="internal xref">Performance Optimization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-hashing-methods" class="internal xref">Hashing Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-chunk-hashes" class="internal xref">Chunk Hashes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-xorb-hashes" class="internal xref">Xorb Hashes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-internal-node-hash-function" class="internal xref">Internal Node Hash Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-merkle-tree-construction" class="internal xref">Merkle Tree Construction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-xorb-hash-computation" class="internal xref">Xorb Hash Computation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-file-hashes" class="internal xref">File Hashes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-term-verification-hashes" class="internal xref">Term Verification Hashes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-hash-string-representation" class="internal xref">Hash String Representation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="auto internal xref">6.5.1</a>.  <a href="#name-conversion-procedure" class="internal xref">Conversion Procedure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="auto internal xref">6.5.2</a>.  <a href="#name-example" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-xorb-format" class="internal xref">Xorb Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-size-constraints" class="internal xref">Size Constraints</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-binary-format" class="internal xref">Binary Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-chunk-header-format" class="internal xref">Chunk Header Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-version-field" class="internal xref">Version Field</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-size-fields" class="internal xref">Size Fields</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="auto internal xref">7.3.3</a>.  <a href="#name-compression-type" class="internal xref">Compression Type</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-compression-schemes" class="internal xref">Compression Schemes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-none-type-0" class="internal xref"><code>None</code> (Type 0)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-lz4-type-1" class="internal xref"><code>LZ4</code> (Type 1)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a href="#section-7.4.3" class="auto internal xref">7.4.3</a>.  <a href="#name-bytegrouping4lz4-type-2" class="internal xref"><code>ByteGrouping4LZ4</code> (Type 2)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4">
                    <p id="section-toc.1-1.7.2.4.2.4.1"><a href="#section-7.4.4" class="auto internal xref">7.4.4</a>.  <a href="#name-compression-selection" class="internal xref">Compression Selection</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-casobjectinfo-footer" class="internal xref"><code>CasObjectInfo</code> Footer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.1">
                    <p id="section-toc.1-1.7.2.5.2.1.1"><a href="#section-7.5.1" class="auto internal xref">7.5.1</a>.  <a href="#name-main-header" class="internal xref">Main Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.2">
                    <p id="section-toc.1-1.7.2.5.2.2.1"><a href="#section-7.5.2" class="auto internal xref">7.5.2</a>.  <a href="#name-hash-section" class="internal xref">Hash Section</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.3">
                    <p id="section-toc.1-1.7.2.5.2.3.1"><a href="#section-7.5.3" class="auto internal xref">7.5.3</a>.  <a href="#name-boundary-section" class="internal xref">Boundary Section</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.4">
                    <p id="section-toc.1-1.7.2.5.2.4.1"><a href="#section-7.5.4" class="auto internal xref">7.5.4</a>.  <a href="#name-trailer" class="internal xref">Trailer</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-file-reconstruction" class="internal xref">File Reconstruction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-term-structure" class="internal xref">Term Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-reconstruction-rules" class="internal xref">Reconstruction Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-range-queries" class="internal xref">Range Queries</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-shard-format" class="internal xref">Shard Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-overall-structure" class="internal xref">Overall Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-data-types" class="internal xref">Data Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-header" class="internal xref">Header</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-9.3.1" class="auto internal xref">9.3.1</a>.  <a href="#name-magic-tag" class="internal xref">Magic Tag</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-file-info-section" class="internal xref">File Info Section</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.1">
                    <p id="section-toc.1-1.9.2.4.2.1.1"><a href="#section-9.4.1" class="auto internal xref">9.4.1</a>.  <a href="#name-file-block-structure" class="internal xref">File Block Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.2">
                    <p id="section-toc.1-1.9.2.4.2.2.1"><a href="#section-9.4.2" class="auto internal xref">9.4.2</a>.  <a href="#name-filedatasequenceheader" class="internal xref"><code>FileDataSequenceHeader</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.3">
                    <p id="section-toc.1-1.9.2.4.2.3.1"><a href="#section-9.4.3" class="auto internal xref">9.4.3</a>.  <a href="#name-filedatasequenceentry" class="internal xref"><code>FileDataSequenceEntry</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.4">
                    <p id="section-toc.1-1.9.2.4.2.4.1"><a href="#section-9.4.4" class="auto internal xref">9.4.4</a>.  <a href="#name-fileverificationentry" class="internal xref"><code>FileVerificationEntry</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.5">
                    <p id="section-toc.1-1.9.2.4.2.5.1"><a href="#section-9.4.5" class="auto internal xref">9.4.5</a>.  <a href="#name-filemetadataext" class="internal xref"><code>FileMetadataExt</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.6">
                    <p id="section-toc.1-1.9.2.4.2.6.1"><a href="#section-9.4.6" class="auto internal xref">9.4.6</a>.  <a href="#name-bookend-entry" class="internal xref">Bookend Entry</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-cas-info-section" class="internal xref">CAS Info Section</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5.2.1">
                    <p id="section-toc.1-1.9.2.5.2.1.1"><a href="#section-9.5.1" class="auto internal xref">9.5.1</a>.  <a href="#name-cas-block-structure" class="internal xref">CAS Block Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5.2.2">
                    <p id="section-toc.1-1.9.2.5.2.2.1"><a href="#section-9.5.2" class="auto internal xref">9.5.2</a>.  <a href="#name-caschunksequenceheader" class="internal xref"><code>CASChunkSequenceHeader</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5.2.3">
                    <p id="section-toc.1-1.9.2.5.2.3.1"><a href="#section-9.5.3" class="auto internal xref">9.5.3</a>.  <a href="#name-caschunksequenceentry" class="internal xref"><code>CASChunkSequenceEntry</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5.2.4">
                    <p id="section-toc.1-1.9.2.5.2.4.1"><a href="#section-9.5.4" class="auto internal xref">9.5.4</a>.  <a href="#name-bookend-entry-2" class="internal xref">Bookend Entry</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-footer" class="internal xref">Footer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6.2.1">
                    <p id="section-toc.1-1.9.2.6.2.1.1"><a href="#section-9.6.1" class="auto internal xref">9.6.1</a>.  <a href="#name-lookup-tables" class="internal xref">Lookup Tables</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6.2.2">
                    <p id="section-toc.1-1.9.2.6.2.2.1"><a href="#section-9.6.2" class="auto internal xref">9.6.2</a>.  <a href="#name-chunk-hash-key-usage" class="internal xref">Chunk Hash Key Usage</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-deduplication" class="internal xref">Deduplication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-local-session-deduplication" class="internal xref">Local Session Deduplication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-cached-metadata-deduplicati" class="internal xref">Cached Metadata Deduplication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-global-deduplication" class="internal xref">Global Deduplication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.1">
                    <p id="section-toc.1-1.10.2.3.2.1.1"><a href="#section-10.3.1" class="auto internal xref">10.3.1</a>.  <a href="#name-eligibility-criteria" class="internal xref">Eligibility Criteria</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.2">
                    <p id="section-toc.1-1.10.2.3.2.2.1"><a href="#section-10.3.2" class="auto internal xref">10.3.2</a>.  <a href="#name-query-process" class="internal xref">Query Process</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.3">
                    <p id="section-toc.1-1.10.2.3.2.3.1"><a href="#section-10.3.3" class="auto internal xref">10.3.3</a>.  <a href="#name-keyed-hash-security" class="internal xref">Keyed Hash Security</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-fragmentation-prevention" class="internal xref">Fragmentation Prevention</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-cas-api" class="internal xref">CAS API</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-authentication" class="internal xref">Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-common-headers" class="internal xref">Common Headers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-get-file-reconstruction" class="internal xref">Get File Reconstruction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-query-chunk-deduplication" class="internal xref">Query Chunk Deduplication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="auto internal xref">11.5</a>.  <a href="#name-upload-xorb" class="internal xref">Upload Xorb</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="auto internal xref">11.6</a>.  <a href="#name-upload-shard" class="internal xref">Upload Shard</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-upload-protocol" class="internal xref">Upload Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-step-1-chunking" class="internal xref">Step 1: Chunking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-step-2-deduplication" class="internal xref">Step 2: Deduplication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-step-3-xorb-formation" class="internal xref">Step 3: Xorb Formation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-step-4-xorb-serialization-a" class="internal xref">Step 4: Xorb Serialization and Upload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-step-5-shard-formation" class="internal xref">Step 5: Shard Formation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref">12.6</a>.  <a href="#name-step-6-shard-upload" class="internal xref">Step 6: Shard Upload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#section-12.7" class="auto internal xref">12.7</a>.  <a href="#name-ordering-and-concurrency" class="internal xref">Ordering and Concurrency</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-download-protocol" class="internal xref">Download Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-step-1-query-reconstruction" class="internal xref">Step 1: Query Reconstruction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-step-2-parse-response" class="internal xref">Step 2: Parse Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-step-3-download-xorb-data" class="internal xref">Step 3: Download Xorb Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="auto internal xref">13.4</a>.  <a href="#name-step-4-extract-chunks" class="internal xref">Step 4: Extract Chunks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-13.5" class="auto internal xref">13.5</a>.  <a href="#name-step-5-assemble-file" class="internal xref">Step 5: Assemble File</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#section-13.6" class="auto internal xref">13.6</a>.  <a href="#name-caching-recommendations" class="internal xref">Caching Recommendations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.7">
                <p id="section-toc.1-1.13.2.7.1"><a href="#section-13.7" class="auto internal xref">13.7</a>.  <a href="#name-error-handling" class="internal xref">Error Handling</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-caching-considerations" class="internal xref">Caching Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-content-immutability" class="internal xref">Content Immutability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-client-side-chunk-caching" class="internal xref">Client-Side Chunk Caching</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.1">
                    <p id="section-toc.1-1.14.2.2.2.1.1"><a href="#section-14.2.1" class="auto internal xref">14.2.1</a>.  <a href="#name-cache-key-design" class="internal xref">Cache Key Design</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.2">
                    <p id="section-toc.1-1.14.2.2.2.2.1"><a href="#section-14.2.2" class="auto internal xref">14.2.2</a>.  <a href="#name-cache-granularity" class="internal xref">Cache Granularity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.3">
                    <p id="section-toc.1-1.14.2.2.2.3.1"><a href="#section-14.2.3" class="auto internal xref">14.2.3</a>.  <a href="#name-eviction-strategies" class="internal xref">Eviction Strategies</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="auto internal xref">14.3</a>.  <a href="#name-xorb-data-caching" class="internal xref">Xorb Data Caching</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.1">
                    <p id="section-toc.1-1.14.2.3.2.1.1"><a href="#section-14.3.1" class="auto internal xref">14.3.1</a>.  <a href="#name-client-side-xorb-cache" class="internal xref">Client-Side Xorb Cache</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.2">
                    <p id="section-toc.1-1.14.2.3.2.2.1"><a href="#section-14.3.2" class="auto internal xref">14.3.2</a>.  <a href="#name-byte-range-considerations" class="internal xref">Byte Range Considerations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="auto internal xref">14.4</a>.  <a href="#name-shard-metadata-caching" class="internal xref">Shard Metadata Caching</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4.2.1">
                    <p id="section-toc.1-1.14.2.4.2.1.1"><a href="#section-14.4.1" class="auto internal xref">14.4.1</a>.  <a href="#name-cache-lifetime" class="internal xref">Cache Lifetime</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4.2.2">
                    <p id="section-toc.1-1.14.2.4.2.2.1"><a href="#section-14.4.2" class="auto internal xref">14.4.2</a>.  <a href="#name-cache-size" class="internal xref">Cache Size</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="auto internal xref">14.5</a>.  <a href="#name-pre-signed-url-handling" class="internal xref">Pre-Signed URL Handling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-14.6" class="auto internal xref">14.6</a>.  <a href="#name-http-caching-headers" class="internal xref">HTTP Caching Headers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6.2.1">
                    <p id="section-toc.1-1.14.2.6.2.1.1"><a href="#section-14.6.1" class="auto internal xref">14.6.1</a>.  <a href="#name-server-recommendations" class="internal xref">Server Recommendations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6.2.2">
                    <p id="section-toc.1-1.14.2.6.2.2.1"><a href="#section-14.6.2" class="auto internal xref">14.6.2</a>.  <a href="#name-client-recommendations" class="internal xref">Client Recommendations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7">
                <p id="section-toc.1-1.14.2.7.1"><a href="#section-14.7" class="auto internal xref">14.7</a>.  <a href="#name-cdn-integration" class="internal xref">CDN Integration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7.2.1">
                    <p id="section-toc.1-1.14.2.7.2.1.1"><a href="#section-14.7.1" class="auto internal xref">14.7.1</a>.  <a href="#name-cdn-cache-keys" class="internal xref">CDN Cache Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7.2.2">
                    <p id="section-toc.1-1.14.2.7.2.2.1"><a href="#section-14.7.2" class="auto internal xref">14.7.2</a>.  <a href="#name-range-request-caching" class="internal xref">Range Request Caching</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.8">
                <p id="section-toc.1-1.14.2.8.1"><a href="#section-14.8" class="auto internal xref">14.8</a>.  <a href="#name-proxy-and-intermediary-cons" class="internal xref">Proxy and Intermediary Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-content-integrity" class="internal xref">Content Integrity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-authentication-and-authoriz" class="internal xref">Authentication and Authorization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="auto internal xref">15.3</a>.  <a href="#name-global-deduplication-privac" class="internal xref">Global Deduplication Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#section-15.4" class="auto internal xref">15.4</a>.  <a href="#name-denial-of-service-considera" class="internal xref">Denial of Service Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref"></a><a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-gearhash-lookup-table" class="internal xref">Gearhash Lookup Table</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-chunk-hash-test-vector" class="internal xref">Chunk Hash Test Vector</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-hash-string-conversion-test" class="internal xref">Hash String Conversion Test Vector</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-internal-node-hash-test-vec" class="internal xref">Internal Node Hash Test Vector</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.4">
                <p id="section-toc.1-1.19.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-verification-range-hash-tes" class="internal xref">Verification Range Hash Test Vector</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.5">
                <p id="section-toc.1-1.19.2.5.1"><a href="#appendix-B.5" class="auto internal xref">B.5</a>.  <a href="#name-reference-files" class="internal xref">Reference Files</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Large-scale data storage and transfer systems face fundamental challenges in efficiency: storing multiple versions of similar files wastes storage space, and transferring unchanged data wastes bandwidth. Traditional approaches such as file-level deduplication miss opportunities to share common content between different files, while fixed-size chunking fails to handle insertions and deletions gracefully.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">XET addresses these challenges through a content-addressable storage protocol that operates at the chunk level. By using content-defined chunking with a rolling hash algorithm, XET creates stable chunk boundaries that remain consistent even when files are modified.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This enables efficient deduplication not only within a single file across versions, but also across entirely different files that happen to share common content.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The protocol is designed around several key principles:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
          <p id="section-1-5.1.1">Determinism: Given the same input data, any conforming implementation <span class="bcp14">MUST</span> produce identical chunks, hashes, and serialized formats, ensuring interoperability.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.2">
          <p id="section-1-5.2.1">Content Addressing: All objects (chunks, xorbs, files) are identified by cryptographic hashes of their content, enabling integrity verification and natural deduplication.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.3">
          <p id="section-1-5.3.1">Efficient Transfer: The reconstruction-based download model allows clients to fetch only the data they need, supporting range queries and parallel downloads.<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.4">
          <p id="section-1-5.4.1">Algorithm Agility: The chunking and hashing algorithms are encapsulated in algorithm suites, enabling future evolution while maintaining compatibility within a deployment.<a href="#section-1-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.5">
          <p id="section-1-5.5.1">Provider Agnostic: While originally developed for machine learning model and dataset storage, XET is a generic protocol applicable to any large file storage scenario.<a href="#section-1-5.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-6">This specification provides complete details necessary for implementing interoperable XET clients and servers. It defines the <code>XET-GEARHASH-BLAKE3</code> algorithm suite as the default, using <code>Gearhash</code> for content-defined chunking and <code>BLAKE3</code> for cryptographic hashing.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="use-cases">
<section id="section-1.1">
        <h3 id="name-use-cases">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
        </h3>
<p id="section-1.1-1">XET is particularly well-suited for scenarios involving:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">Machine Learning: Model checkpoints often share common layers and parameters across versions, enabling significant storage savings through deduplication.<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">Dataset Management: Large datasets with incremental updates benefit from chunk-level deduplication, where only changed portions need to be transferred.<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.3">
            <p id="section-1.1-2.3.1">Version Control: Similar to Git LFS but with content-aware chunking that enables sharing across different files, not just versions of the same file.<a href="#section-1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.4">
            <p id="section-1.1-2.4.1">Content Distribution: The reconstruction-based model enables efficient range queries and partial downloads of large files.<a href="#section-1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words “<span class="bcp14">MUST</span>”, “<span class="bcp14">MUST NOT</span>”, “<span class="bcp14">REQUIRED</span>”, “<span class="bcp14">SHALL</span>”, “<span class="bcp14">SHALL NOT</span>”, “<span class="bcp14">SHOULD</span>”, “<span class="bcp14">SHOULD NOT</span>”, “<span class="bcp14">RECOMMENDED</span>”, “<span class="bcp14">NOT RECOMMENDED</span>”,
“<span class="bcp14">MAY</span>”, and “<span class="bcp14">OPTIONAL</span>” in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Throughout this document, the following terms apply:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Algorithm Suite:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
          <p id="section-2-3.2.1">A specification of the cryptographic hash function and content-defined chunking algorithm used by an XET deployment. All participants in an XET system <span class="bcp14">MUST</span> use the same algorithm suite for interoperability.<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Chunk:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">
          <p id="section-2-3.4.1">A variable-sized unit of data derived from a file using content-defined chunking. Chunks are the fundamental unit of deduplication in XET.<a href="#section-2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Chunk Hash:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">
          <p id="section-2-3.6.1">A 32-byte cryptographic hash that uniquely identifies a chunk based on its content.<a href="#section-2-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">Xorb:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">
          <p id="section-2-3.8.1">A container object that aggregates multiple compressed chunks for efficient storage and transfer. The name derives from “XET orb.”<a href="#section-2-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">Xorb Hash:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.10">
          <p id="section-2-3.10.1">A 32-byte cryptographic hash computed from the chunk hashes within a xorb using a Merkle tree construction.<a href="#section-2-3.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">File Hash:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.12">
          <p id="section-2-3.12.1">A 32-byte cryptographic hash that uniquely identifies a file based on its chunk composition.<a href="#section-2-3.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.13">Shard:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.14">
          <p id="section-2-3.14.1">A binary metadata structure that describes file reconstructions and xorb contents, used for registering uploads and enabling deduplication.<a href="#section-2-3.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.15">Term:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.16">
          <p id="section-2-3.16.1">A reference to a contiguous range of chunks within a specific xorb, used to describe how to reconstruct a file.<a href="#section-2-3.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.17">File Reconstruction:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.18">
          <p id="section-2-3.18.1">An ordered list of terms that describes how to reassemble a file from chunks stored in xorbs.<a href="#section-2-3.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.19">Content-Defined Chunking (CDC):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.20">
          <p id="section-2-3.20.1">An algorithm that determines chunk boundaries based on file content rather than fixed offsets, enabling stable boundaries across file modifications.<a href="#section-2-3.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.21">Content-Addressable Storage (CAS):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.22">
          <p id="section-2-3.22.1">A storage system where objects are addressed by cryptographic hashes of their content rather than by location or name.<a href="#section-2-3.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.23">Global Deduplication:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.24">
          <p id="section-2-3.24.1">The process of identifying chunks that already exist in the storage system to avoid redundant uploads.<a href="#section-2-3.24.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<div id="notational-conventions">
<section id="section-2.1">
        <h3 id="name-notational-conventions">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-2.1-1">All multi-byte integers in binary formats (xorb headers, shard structures) use little-endian byte order unless otherwise specified.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Hash values are 32-byte (256-bit) values. When serialized, they are stored as raw bytes. When displayed as strings, they use a specific byte-swapped hexadecimal format (see <a href="#hash-string-format" class="auto internal xref">Section 6.5</a>).<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Range specifications use different conventions depending on context:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Context</th>
              <th class="text-left" rowspan="1" colspan="1">End Semantics</th>
              <th class="text-left" rowspan="1" colspan="1">Example</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">HTTP <code>Range</code> header</td>
              <td class="text-left" rowspan="1" colspan="1">Inclusive</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>bytes=0-999</code> means bytes 0 through 999</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>url_range</code> in <code>fetch_info</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Inclusive</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>{"start": 0, "end": 999}</code> means bytes 0 through 999</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Chunk index ranges</td>
              <td class="text-left" rowspan="1" colspan="1">Exclusive</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>{"start": 0, "end": 4}</code> means chunks 0, 1, 2, 3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Shard chunk ranges</td>
              <td class="text-left" rowspan="1" colspan="1">Exclusive</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>chunk_index_end</code> is exclusive</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="protocol-overview">
<section id="section-3">
      <h2 id="name-protocol-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-3-1">XET operates as a client-server protocol. Clients perform content-defined chunking locally, query for deduplication opportunities, form xorbs from new chunks, and upload both xorbs and shards to the server. The CAS server provides APIs for reconstruction queries, global deduplication, and persistent storage.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="upload-flow">
<section id="section-3.1">
        <h3 id="name-upload-flow">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-upload-flow" class="section-name selfRef">Upload Flow</a>
        </h3>
<p id="section-3.1-1">The upload process transforms files into content-addressed storage:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-2">
<li id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">Chunking: Split files into variable-sized chunks using content-defined chunking (see <a href="#content-defined-chunking" class="auto internal xref">Section 5</a>).<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">Deduplication: Query for existing chunks to avoid redundant uploads (see <a href="#deduplication" class="auto internal xref">Section 10</a>).<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">Xorb Formation: Group new chunks into xorbs, applying compression (see <a href="#xorb-format" class="auto internal xref">Section 7</a>).<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">Xorb Upload: Upload serialized xorbs to the CAS server.<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.5">
            <p id="section-3.1-2.5.1">Shard Formation: Create shard metadata describing file reconstructions.<a href="#section-3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.6">
            <p id="section-3.1-2.6.1">Shard Upload: Upload the shard to register files in the system.<a href="#section-3.1-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="download-flow">
<section id="section-3.2">
        <h3 id="name-download-flow">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-download-flow" class="section-name selfRef">Download Flow</a>
        </h3>
<p id="section-3.2-1">The download process reconstructs files from stored chunks:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">Reconstruction Query: Request reconstruction information for a file hash.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">Term Processing: Parse the ordered list of terms describing the file.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">Data Fetching: Download required xorb ranges using provided URLs.<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">Chunk Extraction: Deserialize and decompress chunks from xorb data.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-2.5">
            <p id="section-3.2-2.5.1">File Assembly: Concatenate chunks in term order to reconstruct the file.<a href="#section-3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="algorithm-suites">
<section id="section-4">
      <h2 id="name-algorithm-suites">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-algorithm-suites" class="section-name selfRef">Algorithm Suites</a>
      </h2>
<p id="section-4-1">XET is designed as a generic framework where the specific chunking algorithm and cryptographic hash function are parameters defined by an algorithm suite. This enables future algorithm agility while maintaining full backward compatibility within a deployment.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="suite-definition">
<section id="section-4.1">
        <h3 id="name-suite-definition">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-suite-definition" class="section-name selfRef">Suite Definition</a>
        </h3>
<p id="section-4.1-1">An algorithm suite specifies:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-2">
<li id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">Content-Defined Chunking Algorithm: The rolling hash function and boundary detection logic used to split files into chunks.<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">Cryptographic Hash Function: The hash algorithm used for all content addressing (chunk hashes, xorb hashes, file hashes, verification hashes).<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">Keying Material: Domain separation keys for the hash function.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.4">
            <p id="section-4.1-2.4.1">Algorithm Parameters: Chunk size bounds, mask values, lookup tables, and other constants.<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="suite-requirements">
<section id="section-4.2">
        <h3 id="name-suite-requirements">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-suite-requirements" class="section-name selfRef">Suite Requirements</a>
        </h3>
<p id="section-4.2-1">Any conforming algorithm suite <span class="bcp14">MUST</span> satisfy:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">Determinism: Identical inputs <span class="bcp14">MUST</span> produce identical outputs across all implementations.<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1">Collision Resistance: The hash function <span class="bcp14">MUST</span> provide at least 128 bits of collision resistance.<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.3">
            <p id="section-4.2-2.3.1">Preimage Resistance: The hash function <span class="bcp14">MUST</span> provide at least 128 bits of preimage resistance.<a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.4">
            <p id="section-4.2-2.4.1">Keyed Mode: The hash function <span class="bcp14">MUST</span> support keyed operation for domain separation.<a href="#section-4.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="suite-negotiation">
<section id="section-4.3">
        <h3 id="name-suite-negotiation">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-suite-negotiation" class="section-name selfRef">Suite Negotiation</a>
        </h3>
<p id="section-4.3-1">The algorithm suite used by an XET deployment is determined out-of-band, typically by the CAS server configuration. All clients interacting with a given server <span class="bcp14">MUST</span> use the same suite. Binary formats (xorbs, shards) do not contain suite identifiers; the suite is determined implicitly by the deployment context.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defined-suites">
<section id="section-4.4">
        <h3 id="name-defined-suites">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-defined-suites" class="section-name selfRef">Defined Suites</a>
        </h3>
<p id="section-4.4-1">This specification defines one algorithm suite:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1"><code>XET-GEARHASH-BLAKE3</code>: Uses <code>Gearhash</code> for content-defined chunking and <code>BLAKE3</code> for all cryptographic hashing. This is the default and currently only defined suite.<a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-3">Future specifications <span class="bcp14">MAY</span> define additional suites with different algorithms.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="content-defined-chunking">
<section id="section-5">
      <h2 id="name-content-defined-chunking">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-content-defined-chunking" class="section-name selfRef">Content-Defined Chunking</a>
      </h2>
<p id="section-5-1">Content-defined chunking (CDC) splits files into variable-sized chunks based on content rather than fixed offsets. This produces deterministic chunk boundaries that remain stable across file modifications, enabling efficient deduplication.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">This section describes the chunking algorithm for the <code>XET-GEARHASH-BLAKE3</code> suite. Other algorithm suites <span class="bcp14">MAY</span> define different chunking algorithms with different parameters.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="gearhash-algorithm">
<section id="section-5.1">
        <h3 id="name-gearhash-algorithm">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-gearhash-algorithm" class="section-name selfRef">Gearhash Algorithm</a>
        </h3>
<p id="section-5.1-1">The <code>XET-GEARHASH-BLAKE3</code> suite uses a <code>Gearhash</code>-based rolling hash algorithm <span>[<a href="#GEARHASH" class="cite xref">GEARHASH</a>]</span>. <code>Gearhash</code> maintains a 64-bit state that is updated with each input byte using a lookup table, providing fast and deterministic boundary detection.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="algorithm-parameters">
<section id="section-5.2">
        <h3 id="name-algorithm-parameters">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-algorithm-parameters" class="section-name selfRef">Algorithm Parameters</a>
        </h3>
<p id="section-5.2-1">The following constants define the chunking behavior for the <code>XET-GEARHASH-BLAKE3</code> suite:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-2">
<pre>
TARGET_CHUNK_SIZE  = 65536      # 64 KiB (2^16 bytes)
MIN_CHUNK_SIZE     = 8192       # 8 KiB (TARGET / 8)
MAX_CHUNK_SIZE     = 131072     # 128 KiB (TARGET * 2)
MASK               = 0xFFFF000000000000  # 16 one-bits
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3">The <code>Gearhash</code> algorithm uses a lookup table of 256 64-bit constants. Implementations of the <code>XET-GEARHASH-BLAKE3</code> suite <span class="bcp14">MUST</span> use the table defined in <span>[<a href="#GEARHASH" class="cite xref">GEARHASH</a>]</span> (see <a href="#gearhash-table" class="auto internal xref">Appendix A</a> for the complete lookup table).<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="algorithm-description">
<section id="section-5.3">
        <h3 id="name-algorithm-description">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-algorithm-description" class="section-name selfRef">Algorithm Description</a>
        </h3>
<p id="section-5.3-1">The algorithm maintains a 64-bit rolling hash value and processes input bytes sequentially:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-2">
<pre>
function chunk_file(data):
    h = 0                    # 64-bit rolling hash
    start_offset = 0         # Start of current chunk
    chunks = []

    for i from 0 to length(data):
        b = data[i]
        h = ((h &lt;&lt; 1) + TABLE[b]) &amp; 0xFFFFFFFFFFFFFFFF  # 64-bit wrap

        chunk_size = i - start_offset + 1

        # Skip boundary checks until minimum size reached
        if chunk_size &lt; MIN_CHUNK_SIZE:
            continue

        # Force boundary at maximum size
        if chunk_size &gt;= MAX_CHUNK_SIZE:
            chunks.append(data[start_offset : i + 1])
            start_offset = i + 1
            h = 0
            continue

        # Check for natural boundary
        if (h &amp; MASK) == 0:
            chunks.append(data[start_offset : i + 1])
            start_offset = i + 1
            h = 0

    # Emit final chunk if any data remains
    if start_offset &lt; length(data):
        chunks.append(data[start_offset : length(data)])

    return chunks
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="boundary-rules">
<section id="section-5.4">
        <h3 id="name-boundary-rules">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-boundary-rules" class="section-name selfRef">Boundary Rules</a>
        </h3>
<p id="section-5.4-1">The following rules govern chunk boundary placement:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-2">
<li id="section-5.4-2.1">
            <p id="section-5.4-2.1.1">Boundaries <span class="bcp14">MUST NOT</span> be placed before <code>MIN_CHUNK_SIZE</code> bytes have been processed in the current chunk.<a href="#section-5.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-2.2">
            <p id="section-5.4-2.2.1">Boundaries <span class="bcp14">MUST</span> be forced when <code>MAX_CHUNK_SIZE</code> bytes have been processed, regardless of hash value.<a href="#section-5.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-2.3">
            <p id="section-5.4-2.3.1">Between minimum and maximum sizes, boundaries are placed when <code>(h &amp; MASK) == 0</code>.<a href="#section-5.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-2.4">
            <p id="section-5.4-2.4.1">The final chunk <span class="bcp14">MAY</span> be smaller than <code>MIN_CHUNK_SIZE</code> if it represents the end of the file.<a href="#section-5.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-2.5">
            <p id="section-5.4-2.5.1">Files smaller than <code>MIN_CHUNK_SIZE</code> produce a single chunk.<a href="#section-5.4-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="determinism-requirements">
<section id="section-5.5">
        <h3 id="name-determinism-requirements">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-determinism-requirements" class="section-name selfRef">Determinism Requirements</a>
        </h3>
<p id="section-5.5-1">Implementations <span class="bcp14">MUST</span> produce identical chunk boundaries for identical input data. For the <code>XET-GEARHASH-BLAKE3</code> suite, this requires:<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-2.1">
            <p id="section-5.5-2.1.1">Using the exact lookup table values from <a href="#gearhash-table" class="auto internal xref">Appendix A</a><a href="#section-5.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-2.2">
            <p id="section-5.5-2.2.1">Using 64-bit wrapping arithmetic for hash updates<a href="#section-5.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-2.3">
            <p id="section-5.5-2.3.1">Processing bytes in sequential order<a href="#section-5.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-2.4">
            <p id="section-5.5-2.4.1">Applying boundary rules consistently<a href="#section-5.5-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.5-3">Other algorithm suites <span class="bcp14">MUST</span> specify their own determinism requirements.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="performance-optimization">
<section id="section-5.6">
        <h3 id="name-performance-optimization">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-performance-optimization" class="section-name selfRef">Performance Optimization</a>
        </h3>
<p id="section-5.6-1">Implementations <span class="bcp14">MAY</span> skip hash computation for the first <code>MIN_CHUNK_SIZE - 64 - 1</code> bytes of each chunk, as boundary tests are not performed in this region.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">This optimization does not affect output correctness because the <code>Gearhash</code> window is 64 bytes, ensuring the hash state is fully populated by the time boundary tests begin.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="hashing-methods">
<section id="section-6">
      <h2 id="name-hashing-methods">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-hashing-methods" class="section-name selfRef">Hashing Methods</a>
      </h2>
<p id="section-6-1">XET uses cryptographic hashing for content addressing, integrity verification, and deduplication. The specific hash function is determined by the algorithm suite. All hashes are 32 bytes (256 bits) in length.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This section describes the hashing methods for the <code>XET-GEARHASH-BLAKE3</code> suite, which uses <code>BLAKE3</code> keyed hashing <span>[<a href="#BLAKE3" class="cite xref">BLAKE3</a>]</span> for all cryptographic hash computations. Different key values provide domain separation between hash types.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="chunk-hashes">
<section id="section-6.1">
        <h3 id="name-chunk-hashes">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-chunk-hashes" class="section-name selfRef">Chunk Hashes</a>
        </h3>
<p id="section-6.1-1">Chunk hashes uniquely identify individual chunks based on their content. The algorithm suite determines how chunk hashes are computed.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">For the <code>XET-GEARHASH-BLAKE3</code> suite, chunk hashes use <code>BLAKE3</code> keyed hash with <code>DATA_KEY</code>:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-3">
<pre>
DATA_KEY = {
  0x66, 0x97, 0xf5, 0x77, 0x5b, 0x95, 0x50, 0xde,
  0x31, 0x35, 0xcb, 0xac, 0xa5, 0x97, 0x18, 0x1c,
  0x9d, 0xe4, 0x21, 0x10, 0x9b, 0xeb, 0x2b, 0x58,
  0xb4, 0xd0, 0xb0, 0x4b, 0x93, 0xad, 0xf2, 0x29
}
</pre><a href="#section-6.1-3" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-6.1-4">
<pre>
function compute_chunk_hash(chunk_data):
    return blake3_keyed_hash(DATA_KEY, chunk_data)
</pre><a href="#section-6.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="xorb-hashes">
<section id="section-6.2">
        <h3 id="name-xorb-hashes">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-xorb-hashes" class="section-name selfRef">Xorb Hashes</a>
        </h3>
<p id="section-6.2-1">Xorb hashes identify xorbs based on their constituent chunks. The hash is computed using a Merkle tree construction where leaf nodes are chunk hashes. The Merkle tree algorithm is defined independently of the hash function.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="internal-node-hash-function">
<section id="section-6.2.1">
          <h4 id="name-internal-node-hash-function">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-internal-node-hash-function" class="section-name selfRef">Internal Node Hash Function</a>
          </h4>
<p id="section-6.2.1-1">Internal node hashes combine child hashes with their sizes. The hash function is determined by the algorithm suite.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">For the <code>XET-GEARHASH-BLAKE3</code> suite, internal node hashes use <code>BLAKE3</code> keyed hash with <code>INTERNAL_NODE_KEY</code>:<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-3">
<pre>
INTERNAL_NODE_KEY = {
  0x01, 0x7e, 0xc5, 0xc7, 0xa5, 0x47, 0x29, 0x96,
  0xfd, 0x94, 0x66, 0x66, 0xb4, 0x8a, 0x02, 0xe6,
  0x5d, 0xdd, 0x53, 0x6f, 0x37, 0xc7, 0x6d, 0xd2,
  0xf8, 0x63, 0x52, 0xe6, 0x4a, 0x53, 0x71, 0x3f
}
</pre><a href="#section-6.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-4">The input to the hash function is a string formed by concatenating lines for each child:<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-5">
<pre>
{hash_hex} : {size}\n
</pre><a href="#section-6.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-6">Where:<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-7.1">
              <p id="section-6.2.1-7.1.1"><code>{hash_hex}</code> is the 64-character lowercase hexadecimal representation of the child hash as defined in <a href="#hash-string-format" class="auto internal xref">Section 6.5</a><a href="#section-6.2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-7.2">
              <p id="section-6.2.1-7.2.1"><code>{size}</code> is the decimal representation of the child’s byte size<a href="#section-6.2.1-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-7.3">
              <p id="section-6.2.1-7.3.1">Lines are separated by newline characters (<code>\n</code>)<a href="#section-6.2.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-6.2.1-8">
<pre>
function compute_internal_hash(children):
    buffer = ""
    for (hash, size) in children:
        buffer += hash_to_string(hash) + " : " + str(size) + "\n"
    return blake3_keyed_hash(INTERNAL_NODE_KEY, buffer.encode("utf-8"))
</pre><a href="#section-6.2.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="merkle-tree">
<section id="section-6.2.2">
          <h4 id="name-merkle-tree-construction">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-merkle-tree-construction" class="section-name selfRef">Merkle Tree Construction</a>
          </h4>
<p id="section-6.2.2-1">XET uses an aggregated hash tree construction with variable fan-out, not a traditional binary Merkle tree. This algorithm iteratively collapses a list of (hash, size) pairs until a single root hash remains.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<div id="algorithm-parameters-1">
<section id="section-6.2.2.1">
            <h5 id="name-algorithm-parameters-2">
<a href="#section-6.2.2.1" class="section-number selfRef">6.2.2.1. </a><a href="#name-algorithm-parameters-2" class="section-name selfRef">Algorithm Parameters</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-6.2.2.1-1">
<pre>
MEAN_BRANCHING_FACTOR = 4
MIN_CHILDREN = 2
MAX_CHILDREN = 2 * MEAN_BRANCHING_FACTOR + 1  # 9
</pre><a href="#section-6.2.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cut-point-determination">
<section id="section-6.2.2.2">
            <h5 id="name-cut-point-determination">
<a href="#section-6.2.2.2" class="section-number selfRef">6.2.2.2. </a><a href="#name-cut-point-determination" class="section-name selfRef">Cut Point Determination</a>
            </h5>
<p id="section-6.2.2.2-1">The tree structure is determined by the hash values themselves. A cut point occurs when:<a href="#section-6.2.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.2.2-2">
<li id="section-6.2.2.2-2.1">
                <p id="section-6.2.2.2-2.1.1">The minimum number of children (2) has been accumulated AND the current hash modulo MEAN_BRANCHING_FACTOR equals zero, OR<a href="#section-6.2.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.2.2.2-2.2">
                <p id="section-6.2.2.2-2.2.1">The maximum number of children (9) has been reached, OR<a href="#section-6.2.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.2.2.2-2.3">
                <p id="section-6.2.2.2-2.3.1">The end of the input list is reached<a href="#section-6.2.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<div class="alignLeft art-text artwork" id="section-6.2.2.2-3">
<pre>
function next_merge_cut(hashes):
    # hashes is a list of (hash, size) pairs
    # Returns the number of entries to merge (cut point)
    if length(hashes) &lt;= 2:
        return length(hashes)

    end = min(MAX_CHILDREN, length(hashes))

    # Check indices [MIN_CHILDREN-1, end) using 0-based indexing
    for i from (MIN_CHILDREN - 1) to end:
        h = hashes[i].hash
        # Interpret last 8 bytes of hash as little-endian 64-bit unsigned int
        hash_value = bytes_to_u64_le(h[24:32])
        if hash_value % MEAN_BRANCHING_FACTOR == 0:
            return i + 1  # Cut after element i (include i+1 elements)

    return end
</pre><a href="#section-6.2.2.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="merging-hash-sequences">
<section id="section-6.2.2.3">
            <h5 id="name-merging-hash-sequences">
<a href="#section-6.2.2.3" class="section-number selfRef">6.2.2.3. </a><a href="#name-merging-hash-sequences" class="section-name selfRef">Merging Hash Sequences</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-6.2.2.3-1">
<pre>
function merged_hash_of_sequence(hash_pairs):
    # hash_pairs is a list of (hash, size) pairs
    buffer = ""
    total_size = 0

    for (h, s) in hash_pairs:
        buffer += hash_to_string(h) + " : " + str(s) + "\n"
        total_size += s

    new_hash = blake3_keyed_hash(INTERNAL_NODE_KEY, buffer.encode("utf-8"))
    return (new_hash, total_size)
</pre><a href="#section-6.2.2.3-1" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2.3-2">This produces lines like:<a href="#section-6.2.2.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2.3-3">
<pre>
cfc5d07f6f03c29bbf424132963fe08d19a37d5757aaf520bf08119f05cd56d6 : 100
</pre><a href="#section-6.2.2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2.3-4">Each line contains:
- The hash as a fixed-length 64-character lowercase hexadecimal string
- A space, colon, space (<code> : </code>)
- The size as a decimal integer
- A newline character (<code>\n</code>)<a href="#section-6.2.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="root-computation">
<section id="section-6.2.2.4">
            <h5 id="name-root-computation">
<a href="#section-6.2.2.4" class="section-number selfRef">6.2.2.4. </a><a href="#name-root-computation" class="section-name selfRef">Root Computation</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-6.2.2.4-1">
<pre>
function compute_merkle_root(entries):
    # entries is a list of (hash, size) pairs
    if length(entries) == 0:
        return zero_hash()  # 32 zero bytes

    hv = copy(entries)

    while length(hv) &gt; 1:
        write_idx = 0
        read_idx = 0

        while read_idx &lt; length(hv):
            # Find the next cut point
            next_cut = read_idx + next_merge_cut(hv[read_idx:])

            # Merge this slice into one parent node
            hv[write_idx] = merged_hash_of_sequence(hv[read_idx:next_cut])
            write_idx += 1

            read_idx = next_cut

        hv = hv[0:write_idx]

    return hv[0].hash
</pre><a href="#section-6.2.2.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="xorb-hash-computation">
<section id="section-6.2.3">
          <h4 id="name-xorb-hash-computation">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-xorb-hash-computation" class="section-name selfRef">Xorb Hash Computation</a>
          </h4>
<p id="section-6.2.3-1">The xorb hash is the root of a Merkle tree built from chunk hashes:<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3-2">
<pre>
function compute_xorb_hash(chunk_hashes, chunk_sizes):
    # Build leaf entries
    entries = []
    for i from 0 to length(chunk_hashes):
        entries.append((chunk_hashes[i], chunk_sizes[i]))

    # Compute root using the aggregated hash tree algorithm
    return compute_merkle_root(entries)
</pre><a href="#section-6.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="file-hashes">
<section id="section-6.3">
        <h3 id="name-file-hashes">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-file-hashes" class="section-name selfRef">File Hashes</a>
        </h3>
<p id="section-6.3-1">File hashes identify files based on their complete chunk composition. The computation is similar to xorb hashes, but with an additional final keyed hash step for domain separation.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">For the <code>XET-GEARHASH-BLAKE3</code> suite, file hashes use an all-zero key (<code>ZERO_KEY</code>) for the final hash:<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-3">
<pre>
ZERO_KEY = {
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
}
</pre><a href="#section-6.3-3" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-6.3-4">
<pre>
function compute_file_hash(chunk_hashes, chunk_sizes):
    # Build (hash, size) pairs for Merkle tree
    entries = zip(chunk_hashes, chunk_sizes)
    merkle_root = compute_merkle_root(entries)
    return blake3_keyed_hash(ZERO_KEY, merkle_root)
</pre><a href="#section-6.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3-5">For empty files (zero bytes), there are no chunks, so <code>compute_merkle_root([])</code> returns 32 zero bytes. The file hash is therefore <code>blake3_keyed_hash(ZERO_KEY, zero_hash())</code>, where <code>zero_hash()</code> is 32 zero bytes.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-hashes">
<section id="section-6.4">
        <h3 id="name-term-verification-hashes">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-term-verification-hashes" class="section-name selfRef">Term Verification Hashes</a>
        </h3>
<p id="section-6.4-1">Term verification hashes are used in shards to prove that the uploader possesses the actual file data, not just metadata. The hash function is determined by the algorithm suite.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">For the <code>XET-GEARHASH-BLAKE3</code> suite, verification hashes use <code>BLAKE3</code> keyed hash with <code>VERIFICATION_KEY</code>:<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4-3">
<pre>
VERIFICATION_KEY = {
  0x7f, 0x18, 0x57, 0xd6, 0xce, 0x56, 0xed, 0x66,
  0x12, 0x7f, 0xf9, 0x13, 0xe7, 0xa5, 0xc3, 0xf3,
  0xa4, 0xcd, 0x26, 0xd5, 0xb5, 0xdb, 0x49, 0xe6,
  0x41, 0x24, 0x98, 0x7f, 0x28, 0xfb, 0x94, 0xc3
}
</pre><a href="#section-6.4-3" class="pilcrow">¶</a>
</div>
<p id="section-6.4-4">The input is the raw concatenation of chunk hashes (not hex-encoded) for the term’s chunk range:<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4-5">
<pre>
function compute_verification_hash(chunk_hashes, start_index, end_index):
    buffer = bytes()
    for i from start_index to end_index:  # end_index is exclusive
        buffer += chunk_hashes[i]  # 32 bytes each
    return blake3_keyed_hash(VERIFICATION_KEY, buffer)
</pre><a href="#section-6.4-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="hash-string-format">
<section id="section-6.5">
        <h3 id="name-hash-string-representation">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-hash-string-representation" class="section-name selfRef">Hash String Representation</a>
        </h3>
<p id="section-6.5-1">When representing hashes as strings (e.g., in API paths), a specific byte reordering is applied before hexadecimal encoding.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<div id="conversion-procedure">
<section id="section-6.5.1">
          <h4 id="name-conversion-procedure">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-conversion-procedure" class="section-name selfRef">Conversion Procedure</a>
          </h4>
<p id="section-6.5.1-1">The 32-byte hash is interpreted as four little-endian 64-bit unsigned values, and each value is printed as 16 hexadecimal digits:<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.5.1-2">
<li id="section-6.5.1-2.1">
              <p id="section-6.5.1-2.1.1">Divide the 32-byte hash into four 8-byte segments<a href="#section-6.5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.1-2.2">
              <p id="section-6.5.1-2.2.1">Interpret each segment as a little-endian 64-bit unsigned value<a href="#section-6.5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.1-2.3">
              <p id="section-6.5.1-2.3.1">Format each value as a zero-padded 16-character lowercase hexadecimal string<a href="#section-6.5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.5.1-2.4">
              <p id="section-6.5.1-2.4.1">Concatenate the four strings (64 characters total)<a href="#section-6.5.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-6.5.1-3">
<pre>
function hash_to_string(hash):
    out = ""
    for segment in 0..4:                       # segments 0,1,2,3
        offset = segment * 8
        value  = little_endian_to_u64(hash[offset : offset + 8])
        out   += format("{:016x}", value)      # always 16 hex digits
    return out

function string_to_hash(hex_string):
    hash = []
    for segment in 0..4:
        start = segment * 16
        value = parse_u64_from_hex(hex_string[start : start + 16])
        hash.extend(u64_to_little_endian_bytes(value))
    return hash
</pre><a href="#section-6.5.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example">
<section id="section-6.5.2">
          <h4 id="name-example">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-example" class="section-name selfRef">Example</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-6.5.2-1">
<pre>
Original hash bytes (indices 0-31):
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]

Reordered bytes:
[7, 6, 5, 4, 3, 2, 1, 0, 15, 14, 13, 12, 11, 10, 9, 8,
 23, 22, 21, 20, 19, 18, 17, 16, 31, 30, 29, 28, 27, 26, 25, 24]

String representation:
07060504030201000f0e0d0c0b0a090817161514131211101f1e1d1c1b1a1918
</pre><a href="#section-6.5.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="xorb-format">
<section id="section-7">
      <h2 id="name-xorb-format">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-xorb-format" class="section-name selfRef">Xorb Format</a>
      </h2>
<p id="section-7-1">A xorb is a container that aggregates multiple compressed chunks for efficient storage and transfer. Xorbs are identified by their xorb hash (see <a href="#xorb-hashes" class="auto internal xref">Section 6.2</a>).<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="size-constraints">
<section id="section-7.1">
        <h3 id="name-size-constraints">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-size-constraints" class="section-name selfRef">Size Constraints</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-7.1-1">
<pre>
MAX_XORB_SIZE   = 67108864  # 64 MiB maximum serialized size
MAX_XORB_CHUNKS = 8192      # Maximum chunks per xorb
</pre><a href="#section-7.1-1" class="pilcrow">¶</a>
</div>
<p id="section-7.1-2">Implementations <span class="bcp14">MUST NOT</span> exceed either limit. When collecting chunks:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-3">
<li id="section-7.1-3.1">
            <p id="section-7.1-3.1.1">Stop if adding the next chunk would exceed <code>MAX_XORB_SIZE</code><a href="#section-7.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-3.2">
            <p id="section-7.1-3.2.1">Stop if the chunk count would exceed <code>MAX_XORB_CHUNKS</code><a href="#section-7.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-3.3">
            <p id="section-7.1-3.3.1">Target approximately 1,024 chunks per xorb for typical workloads<a href="#section-7.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="binary-format">
<section id="section-7.2">
        <h3 id="name-binary-format">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-binary-format" class="section-name selfRef">Binary Format</a>
        </h3>
<p id="section-7.2-1">Serialized xorbs have a footer so readers can locate metadata by seeking from the end:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-2">
<pre>
+-------------------------------------------------------------+
|                 Chunk Data Region (variable)                |
|   [chunk header + compressed bytes repeated per chunk]      |
+-------------------------------------------------------------+
|                 CasObjectInfo Footer (variable)             |
+-------------------------------------------------------------+
|     Info Length (32-bit unsigned LE, footer length only)    |
+-------------------------------------------------------------+
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.2-3">The final 4-byte little-endian integer stores the length of the <code>CasObjectInfo</code> block immediately preceding it (the length does not include the 4-byte length field itself).<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">The chunk data region consists of consecutive chunk entries, each containing an 8-byte header followed by the compressed chunk data.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chunk-header-format">
<section id="section-7.3">
        <h3 id="name-chunk-header-format">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-chunk-header-format" class="section-name selfRef">Chunk Header Format</a>
        </h3>
<p id="section-7.3-1">Each chunk header is 8 bytes with the following layout:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Offset</th>
              <th class="text-left" rowspan="1" colspan="1">Size</th>
              <th class="text-left" rowspan="1" colspan="1">Field</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Version (must be 0)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Compressed Size (little-endian, bytes)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Compression Type</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Uncompressed Size (little-endian, bytes)</td>
            </tr>
          </tbody>
        </table>
<div id="version-field">
<section id="section-7.3.1">
          <h4 id="name-version-field">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-version-field" class="section-name selfRef">Version Field</a>
          </h4>
<p id="section-7.3.1-1">The version field <span class="bcp14">MUST</span> be <code>0</code> for this specification. Implementations <span class="bcp14">MUST</span> reject chunks with unknown version values.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="size-fields">
<section id="section-7.3.2">
          <h4 id="name-size-fields">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-size-fields" class="section-name selfRef">Size Fields</a>
          </h4>
<p id="section-7.3.2-1">Both size fields use 3-byte little-endian encoding, supporting values up to 16,777,215 bytes. Given the maximum chunk size of 128 KiB, this provides ample range.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compression-type">
<section id="section-7.3.3">
          <h4 id="name-compression-type">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-compression-type" class="section-name selfRef">Compression Type</a>
          </h4>
<table class="center" id="table-3">
            <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>None</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">No compression; data stored as-is</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>LZ4</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>LZ4</code> Frame format compression</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>ByteGrouping4LZ4</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Byte grouping preprocessing followed by <code>LZ4</code>
</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="compression-schemes">
<section id="section-7.4">
        <h3 id="name-compression-schemes">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-compression-schemes" class="section-name selfRef">Compression Schemes</a>
        </h3>
<div id="none-type-0">
<section id="section-7.4.1">
          <h4 id="name-none-type-0">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-none-type-0" class="section-name selfRef"><code>None</code> (Type 0)</a>
          </h4>
<p id="section-7.4.1-1">Data is stored without modification. Used when compression would increase size or for already-compressed data.<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lz4-type-1">
<section id="section-7.4.2">
          <h4 id="name-lz4-type-1">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-lz4-type-1" class="section-name selfRef"><code>LZ4</code> (Type 1)</a>
          </h4>
<p id="section-7.4.2-1"><code>LZ4</code> Frame format compression <span>[<a href="#LZ4" class="cite xref">LZ4</a>]</span> (not <code>LZ4</code> block format). Each compressed chunk is a complete <code>LZ4</code> frame. This is the default compression scheme for most data.<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bytegrouping4lz4-type-2">
<section id="section-7.4.3">
          <h4 id="name-bytegrouping4lz4-type-2">
<a href="#section-7.4.3" class="section-number selfRef">7.4.3. </a><a href="#name-bytegrouping4lz4-type-2" class="section-name selfRef"><code>ByteGrouping4LZ4</code> (Type 2)</a>
          </h4>
<p id="section-7.4.3-1">A two-stage compression optimized for structured data (e.g., floating-point arrays):<a href="#section-7.4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.4.3-2">
<li id="section-7.4.3-2.1">
              <p id="section-7.4.3-2.1.1">Byte Grouping Phase: Reorganize bytes by position within 4-byte groups<a href="#section-7.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.4.3-2.2">
              <p id="section-7.4.3-2.2.1"><code>LZ4</code> Compression: Apply <code>LZ4</code> to the reorganized data<a href="#section-7.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-7.4.3-3">Byte grouping transformation:<a href="#section-7.4.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.4.3-4">
<pre>
Original:  [A0 A1 A2 A3 | B0 B1 B2 B3 | C0 C1 C2 C3 | ...]
Grouped:   [A0 B0 C0 ... | A1 B1 C1 ... | A2 B2 C2 ... | A3 B3 C3 ...]
</pre><a href="#section-7.4.3-4" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-7.4.3-5">
<pre>
function byte_group_4(data):
    n = length(data)
    groups = [[], [], [], []]

    for i from 0 to n:
        groups[i % 4].append(data[i])

    return concatenate(groups[0], groups[1], groups[2], groups[3])

function byte_ungroup_4(grouped_data, original_length):
    n = original_length
    base_size = n / 4
    remainder = n % 4

    # Calculate group sizes
    sizes = [base_size + (1 if i &lt; remainder else 0) for i in range(4)]

    # Extract groups
    groups = []
    offset = 0
    for size in sizes:
        groups.append(grouped_data[offset : offset + size])
        offset += size

    # Interleave back to original order
    data = []
    for i from 0 to n:
        group_idx = i % 4
        pos_in_group = i / 4
        data.append(groups[group_idx][pos_in_group])

    return data
</pre><a href="#section-7.4.3-5" class="pilcrow">¶</a>
</div>
<p id="section-7.4.3-6">When the data length is not a multiple of 4, the remainder bytes are distributed to the first groups. For example, with 10 bytes the group sizes are 3, 3, 2, 2 (first two groups get the extra bytes).<a href="#section-7.4.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compression-selection">
<section id="section-7.4.4">
          <h4 id="name-compression-selection">
<a href="#section-7.4.4" class="section-number selfRef">7.4.4. </a><a href="#name-compression-selection" class="section-name selfRef">Compression Selection</a>
          </h4>
<p id="section-7.4.4-1">Implementations <span class="bcp14">MAY</span> use any strategy to select compression schemes. If compression increases size, implementations <span class="bcp14">SHOULD</span> use compression type <code>0</code> (<code>None</code>).<a href="#section-7.4.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4.4-2"><code>ByteGrouping4LZ4</code> (Type 2) is typically beneficial for structured numerical data such as <code>float32</code> or <code>float16</code> tensors, where bytes at the same position within 4-byte groups tend to be similar.<a href="#section-7.4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="casobjectinfo-footer">
<section id="section-7.5">
        <h3 id="name-casobjectinfo-footer">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-casobjectinfo-footer" class="section-name selfRef"><code>CasObjectInfo</code> Footer</a>
        </h3>
<p id="section-7.5-1">The metadata footer sits immediately before the 4-byte length trailer. Implementations <span class="bcp14">MUST</span> serialize fields in this exact order and reject unknown idents or versions.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<div id="main-header">
<section id="section-7.5.1">
          <h4 id="name-main-header">
<a href="#section-7.5.1" class="section-number selfRef">7.5.1. </a><a href="#name-main-header" class="section-name selfRef">Main Header</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-7.5.1-1.1">
              <p id="section-7.5.1-1.1.1">Ident: <code>"XETBLOB"</code> (7 ASCII bytes)<a href="#section-7.5.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.1-1.2">
              <p id="section-7.5.1-1.2.1">Version: 8-bit unsigned, <span class="bcp14">MUST</span> be <code>1</code><a href="#section-7.5.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.1-1.3">
              <p id="section-7.5.1-1.3.1">Xorb hash: 32-byte Merkle hash from <a href="#xorb-hashes" class="auto internal xref">Section 6.2</a><a href="#section-7.5.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hash-section">
<section id="section-7.5.2">
          <h4 id="name-hash-section">
<a href="#section-7.5.2" class="section-number selfRef">7.5.2. </a><a href="#name-hash-section" class="section-name selfRef">Hash Section</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-7.5.2-1.1">
              <p id="section-7.5.2-1.1.1">Ident: <code>"XBLBHSH"</code> (7 bytes)<a href="#section-7.5.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.2-1.2">
              <p id="section-7.5.2-1.2.1">Hashes version: 8-bit unsigned, <span class="bcp14">MUST</span> be <code>0</code><a href="#section-7.5.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.2-1.3">
              <p id="section-7.5.2-1.3.1"><code>num_chunks</code>: 32-bit unsigned<a href="#section-7.5.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.2-1.4">
              <p id="section-7.5.2-1.4.1">Chunk hashes: 32 bytes each, in chunk order<a href="#section-7.5.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="boundary-section">
<section id="section-7.5.3">
          <h4 id="name-boundary-section">
<a href="#section-7.5.3" class="section-number selfRef">7.5.3. </a><a href="#name-boundary-section" class="section-name selfRef">Boundary Section</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-7.5.3-1.1">
              <p id="section-7.5.3-1.1.1">Ident: <code>"XBLBBND"</code> (7 bytes)<a href="#section-7.5.3-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.3-1.2">
              <p id="section-7.5.3-1.2.1">Boundaries version: 8-bit unsigned, <span class="bcp14">MUST</span> be <code>1</code><a href="#section-7.5.3-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.3-1.3">
              <p id="section-7.5.3-1.3.1"><code>num_chunks</code>: 32-bit unsigned<a href="#section-7.5.3-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.3-1.4">
              <p id="section-7.5.3-1.4.1">Chunk boundary offsets: Array of <code>num_chunks</code> 32-bit unsigned values. Each value is the end offset (in bytes) of the corresponding chunk in the serialized chunk data region, <strong>including headers</strong>. Chunk 0 starts at offset 0; chunk <code>i</code> starts at <code>chunk_boundary_offsets[i-1]</code>.<a href="#section-7.5.3-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.3-1.5">
              <p id="section-7.5.3-1.5.1">Unpacked chunk offsets: Array of <code>num_chunks</code> 32-bit unsigned values. Each value is the end offset of the corresponding chunk in the concatenated uncompressed stream.<a href="#section-7.5.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="trailer">
<section id="section-7.5.4">
          <h4 id="name-trailer">
<a href="#section-7.5.4" class="section-number selfRef">7.5.4. </a><a href="#name-trailer" class="section-name selfRef">Trailer</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-7.5.4-1.1">
              <p id="section-7.5.4-1.1.1"><code>num_chunks</code>: 32-bit unsigned (repeated for convenience)<a href="#section-7.5.4-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.4-1.2">
              <p id="section-7.5.4-1.2.1">Hashes section offset from end: 32-bit unsigned distance from the end of the footer to the start of the hash section<a href="#section-7.5.4-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.4-1.3">
              <p id="section-7.5.4-1.3.1">Boundary section offset from end: 32-bit unsigned distance from the end of the footer to the start of the boundary section<a href="#section-7.5.4-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.5.4-1.4">
              <p id="section-7.5.4-1.4.1">Reserved: 16 bytes, zero<a href="#section-7.5.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.5.4-2">The 4-byte length trailer that follows the footer stores <code>info_length</code> (little-endian 32-bit unsigned) for the <code>CasObjectInfo</code> block only. This length field is not counted inside the footer itself.<a href="#section-7.5.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="file-reconstruction">
<section id="section-8">
      <h2 id="name-file-reconstruction">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-file-reconstruction" class="section-name selfRef">File Reconstruction</a>
      </h2>
<p id="section-8-1">A file reconstruction is an ordered list of terms that describes how to reassemble a file from chunks stored in xorbs.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="term-structure">
<section id="section-8.1">
        <h3 id="name-term-structure">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-term-structure" class="section-name selfRef">Term Structure</a>
        </h3>
<p id="section-8.1-1">Each term specifies:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1">Xorb Hash: Identifies the xorb containing the chunks<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.2">
            <p id="section-8.1-2.2.1">Chunk Range: Start (inclusive) and end (exclusive) indices within the xorb<a href="#section-8.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.3">
            <p id="section-8.1-2.3.1">Unpacked Length: Expected byte count after decompression (for validation)<a href="#section-8.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="reconstruction-rules">
<section id="section-8.2">
        <h3 id="name-reconstruction-rules">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-reconstruction-rules" class="section-name selfRef">Reconstruction Rules</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-8.2-1">
<li id="section-8.2-1.1">
            <p id="section-8.2-1.1.1">Terms <span class="bcp14">MUST</span> be processed in order.<a href="#section-8.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-1.2">
            <p id="section-8.2-1.2.1">For each term, extract chunks at indices <code>[start, end)</code> from the specified xorb.<a href="#section-8.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-1.3">
            <p id="section-8.2-1.3.1">Decompress chunks according to their compression headers.<a href="#section-8.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-1.4">
            <p id="section-8.2-1.4.1">Concatenate decompressed chunk data in order.<a href="#section-8.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-1.5">
            <p id="section-8.2-1.5.1">For range queries, apply <code>offset_into_first_range</code> to skip initial bytes.<a href="#section-8.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-1.6">
            <p id="section-8.2-1.6.1">Validate that the total reconstructed size matches expectations.<a href="#section-8.2-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="range-queries">
<section id="section-8.3">
        <h3 id="name-range-queries">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-range-queries" class="section-name selfRef">Range Queries</a>
        </h3>
<p id="section-8.3-1">When downloading a byte range rather than the complete file:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.3-2">
<li id="section-8.3-2.1">
            <p id="section-8.3-2.1.1">The reconstruction API returns only terms overlapping the requested range.<a href="#section-8.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.3-2.2">
            <p id="section-8.3-2.2.1">The <code>offset_into_first_range</code> field indicates bytes to skip in the first term.<a href="#section-8.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.3-2.3">
            <p id="section-8.3-2.3.1">The client <span class="bcp14">MUST</span> truncate output to match the requested range length.<a href="#section-8.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="shard-format">
<section id="section-9">
      <h2 id="name-shard-format">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-shard-format" class="section-name selfRef">Shard Format</a>
      </h2>
<p id="section-9-1">A shard is a binary metadata structure that describes file reconstructions and xorb contents. Shards serve two purposes:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9-2">
<li id="section-9-2.1">
          <p id="section-9-2.1.1">Upload Registration: Describing newly uploaded files and xorbs to the CAS server<a href="#section-9-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-9-2.2">
          <p id="section-9-2.2.1">Deduplication Response: Providing information about existing chunks for deduplication<a href="#section-9-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<div id="overall-structure">
<section id="section-9.1">
        <h3 id="name-overall-structure">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-overall-structure" class="section-name selfRef">Overall Structure</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-9.1-1">
<pre>
+--------------------------------------------------------+
|                    Header (48 bytes)                   |
+--------------------------------------------------------+
|                    File Info Section                   |
|              (variable, ends with bookend)             |
+--------------------------------------------------------+
|                    CAS Info Section                    |
|              (variable, ends with bookend)             |
+--------------------------------------------------------+
|                   Footer (200 bytes)                   |
|                (omitted for upload API)                |
+--------------------------------------------------------+
</pre><a href="#section-9.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="data-types">
<section id="section-9.2">
        <h3 id="name-data-types">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-data-types" class="section-name selfRef">Data Types</a>
        </h3>
<p id="section-9.2-1">All multi-byte integers are little-endian. Field sizes are stated explicitly (e.g., “8-bit unsigned”, “32-bit unsigned”, “64-bit unsigned”). Hash denotes a 32-byte (256-bit) value.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="shard-header">
<section id="section-9.3">
        <h3 id="name-header">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-header" class="section-name selfRef">Header</a>
        </h3>
<p id="section-9.3-1">The header is 48 bytes at offset 0:<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3-2">
<pre>
Offset  Size  Field
------  ----  -----
0       32    Tag (magic identifier)
32      8     Version (64-bit unsigned, MUST be 2)
40      8     Footer Size (64-bit unsigned, 0 if footer omitted)
</pre><a href="#section-9.3-2" class="pilcrow">¶</a>
</div>
<p id="section-9.3-3">The header version (<code>2</code>) and footer version (<code>1</code>) are independent version numbers that may evolve separately.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<div id="magic-tag">
<section id="section-9.3.1">
          <h4 id="name-magic-tag">
<a href="#section-9.3.1" class="section-number selfRef">9.3.1. </a><a href="#name-magic-tag" class="section-name selfRef">Magic Tag</a>
          </h4>
<p id="section-9.3.1-1">The 32-byte magic tag identifies the shard format and the application deployment:<a href="#section-9.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3.1-2">
<pre>
Offset  Size  Field
------  ----  -----
0       14    Application Identifier (ASCII, null-padded)
14      1     Null byte (0x00)
15      17    Magic sequence (fixed)
</pre><a href="#section-9.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-9.3.1-3">The magic sequence (bytes 15-31) <span class="bcp14">MUST</span> be exactly:<a href="#section-9.3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3.1-4">
<pre>
SHARD_MAGIC_SEQUENCE = {
  0x55, 0x69, 0x67, 0x45, 0x6a, 0x7b, 0x81, 0x57,
  0x83, 0xa5, 0xbd, 0xd9, 0x5c, 0xcd, 0xd1, 0x4a, 0xa9
}
</pre><a href="#section-9.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-9.3.1-5">The application identifier (bytes 0-13) is deployment-specific and identifies the XET application context. For Hugging Face deployments, the identifier <span class="bcp14">MUST</span> be <code>"HFRepoMetaData"</code> (ASCII):<a href="#section-9.3.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3.1-6">
<pre>
HF_APPLICATION_ID = {
  0x48, 0x46, 0x52, 0x65, 0x70, 0x6f, 0x4d, 0x65,
  0x74, 0x61, 0x44, 0x61, 0x74, 0x61
}
</pre><a href="#section-9.3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-9.3.1-7">Other deployments <span class="bcp14">MAY</span> define their own application identifiers. If the identifier is shorter than 14 bytes, it <span class="bcp14">MUST</span> be null-padded on the right.<a href="#section-9.3.1-7" class="pilcrow">¶</a></p>
<p id="section-9.3.1-8">Implementations <span class="bcp14">MUST</span> verify that bytes 14-31 match the expected magic sequence before processing. Implementations <span class="bcp14">MAY</span> additionally verify the application identifier to ensure compatibility with the expected deployment.<a href="#section-9.3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="file-info-section">
<section id="section-9.4">
        <h3 id="name-file-info-section">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-file-info-section" class="section-name selfRef">File Info Section</a>
        </h3>
<p id="section-9.4-1">The file info section contains zero or more file blocks, each describing a file reconstruction. The section ends with a bookend entry.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<div id="file-block-structure">
<section id="section-9.4.1">
          <h4 id="name-file-block-structure">
<a href="#section-9.4.1" class="section-number selfRef">9.4.1. </a><a href="#name-file-block-structure" class="section-name selfRef">File Block Structure</a>
          </h4>
<p id="section-9.4.1-1">Each file block contains:<a href="#section-9.4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.4.1-2">
<li id="section-9.4.1-2.1">
              <p id="section-9.4.1-2.1.1"><code>FileDataSequenceHeader</code> (48 bytes)<a href="#section-9.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.4.1-2.2">
              <p id="section-9.4.1-2.2.1"><code>FileDataSequenceEntry</code> entries (48 bytes each, count from header)<a href="#section-9.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.4.1-2.3">
              <p id="section-9.4.1-2.3.1"><code>FileVerificationEntry</code> entries (48 bytes each, if flag set)<a href="#section-9.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.4.1-2.4">
              <p id="section-9.4.1-2.4.1"><code>FileMetadataExt</code> (48 bytes, if flag set)<a href="#section-9.4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="filedatasequenceheader">
<section id="section-9.4.2">
          <h4 id="name-filedatasequenceheader">
<a href="#section-9.4.2" class="section-number selfRef">9.4.2. </a><a href="#name-filedatasequenceheader" class="section-name selfRef"><code>FileDataSequenceHeader</code></a>
          </h4>
<div class="alignLeft art-text artwork" id="section-9.4.2-1">
<pre>
Offset  Size  Field
------  ----  -----
0       32    File Hash
32      4     File Flags (32-bit unsigned)
36      4     Number of Entries (32-bit unsigned)
40      8     Reserved (zeros)
</pre><a href="#section-9.4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-9.4.2-2">File Flags:<a href="#section-9.4.2-2" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
            <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Bit</th>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">31</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>WITH_VERIFICATION</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>FileVerificationEntry</code> present for each entry</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">30</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>WITH_METADATA_EXT</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>FileMetadataExt</code> present at end</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="filedatasequenceentry">
<section id="section-9.4.3">
          <h4 id="name-filedatasequenceentry">
<a href="#section-9.4.3" class="section-number selfRef">9.4.3. </a><a href="#name-filedatasequenceentry" class="section-name selfRef"><code>FileDataSequenceEntry</code></a>
          </h4>
<p id="section-9.4.3-1">Each entry describes a term in the file reconstruction:<a href="#section-9.4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.4.3-2">
<pre>
Offset  Size  Field
------  ----  -----
0       32    CAS Hash (xorb hash)
32      4     CAS Flags (32-bit unsigned, reserved, MUST be set to 0)
36      4     Unpacked Segment Bytes (32-bit unsigned)
40      4     Chunk Index Start (32-bit unsigned)
44      4     Chunk Index End (32-bit unsigned, exclusive)
</pre><a href="#section-9.4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-9.4.3-3">The chunk range is specified as <code>[chunk_index_start, chunk_index_end)</code> (end-exclusive).<a href="#section-9.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fileverificationentry">
<section id="section-9.4.4">
          <h4 id="name-fileverificationentry">
<a href="#section-9.4.4" class="section-number selfRef">9.4.4. </a><a href="#name-fileverificationentry" class="section-name selfRef"><code>FileVerificationEntry</code></a>
          </h4>
<p id="section-9.4.4-1">Present only when <code>WITH_VERIFICATION</code> flag is set:<a href="#section-9.4.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.4.4-2">
<pre>
Offset  Size  Field
------  ----  -----
0       32    Range Hash (verification hash)
32      16    Reserved (zeros)
</pre><a href="#section-9.4.4-2" class="pilcrow">¶</a>
</div>
<p id="section-9.4.4-3">The range hash is computed as described in <a href="#verification-hashes" class="auto internal xref">Section 6.4</a>.<a href="#section-9.4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="filemetadataext">
<section id="section-9.4.5">
          <h4 id="name-filemetadataext">
<a href="#section-9.4.5" class="section-number selfRef">9.4.5. </a><a href="#name-filemetadataext" class="section-name selfRef"><code>FileMetadataExt</code></a>
          </h4>
<p id="section-9.4.5-1">Present only when <code>WITH_METADATA_EXT</code> flag is set:<a href="#section-9.4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.4.5-2">
<pre>
Offset  Size  Field
------  ----  -----
0       32    SHA-256 Hash of file contents
32      16    Reserved (zeros)
</pre><a href="#section-9.4.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="bookend-entry">
<section id="section-9.4.6">
          <h4 id="name-bookend-entry">
<a href="#section-9.4.6" class="section-number selfRef">9.4.6. </a><a href="#name-bookend-entry" class="section-name selfRef">Bookend Entry</a>
          </h4>
<p id="section-9.4.6-1">The file info section ends with a 48-byte bookend:<a href="#section-9.4.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4.6-2.1">
              <p id="section-9.4.6-2.1.1">Bytes 0-31: All <code>0xFF</code><a href="#section-9.4.6-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.4.6-2.2">
              <p id="section-9.4.6-2.2.1">Bytes 32-47: All <code>0x00</code><a href="#section-9.4.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="cas-info-section">
<section id="section-9.5">
        <h3 id="name-cas-info-section">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-cas-info-section" class="section-name selfRef">CAS Info Section</a>
        </h3>
<p id="section-9.5-1">The CAS info section contains zero or more CAS blocks, each describing a xorb and its chunks. The section ends with a bookend entry.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<div id="cas-block-structure">
<section id="section-9.5.1">
          <h4 id="name-cas-block-structure">
<a href="#section-9.5.1" class="section-number selfRef">9.5.1. </a><a href="#name-cas-block-structure" class="section-name selfRef">CAS Block Structure</a>
          </h4>
<p id="section-9.5.1-1">Each CAS block contains:<a href="#section-9.5.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.5.1-2">
<li id="section-9.5.1-2.1">
              <p id="section-9.5.1-2.1.1"><code>CASChunkSequenceHeader</code> (48 bytes)<a href="#section-9.5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.5.1-2.2">
              <p id="section-9.5.1-2.2.1"><code>CASChunkSequenceEntry</code> entries (48 bytes each, count from header)<a href="#section-9.5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="caschunksequenceheader">
<section id="section-9.5.2">
          <h4 id="name-caschunksequenceheader">
<a href="#section-9.5.2" class="section-number selfRef">9.5.2. </a><a href="#name-caschunksequenceheader" class="section-name selfRef"><code>CASChunkSequenceHeader</code></a>
          </h4>
<div class="alignLeft art-text artwork" id="section-9.5.2-1">
<pre>
Offset  Size  Field
------  ----  -----
0       32    CAS Hash (xorb hash)
32      4     CAS Flags (32-bit unsigned, reserved, MUST be set to 0)
36      4     Number of Entries (32-bit unsigned)
40      4     Num Bytes in CAS (32-bit unsigned, total uncompressed)
44      4     Num Bytes on Disk (32-bit unsigned, serialized xorb size)
</pre><a href="#section-9.5.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="caschunksequenceentry">
<section id="section-9.5.3">
          <h4 id="name-caschunksequenceentry">
<a href="#section-9.5.3" class="section-number selfRef">9.5.3. </a><a href="#name-caschunksequenceentry" class="section-name selfRef"><code>CASChunkSequenceEntry</code></a>
          </h4>
<div class="alignLeft art-text artwork" id="section-9.5.3-1">
<pre>
Offset  Size  Field
------  ----  -----
0       32    Chunk Hash
32      4     Chunk Byte Range Start (32-bit unsigned)
36      4     Unpacked Segment Bytes (32-bit unsigned)
40      4     Flags (32-bit unsigned)
44      4     Reserved (32-bit unsigned, zeros)
</pre><a href="#section-9.5.3-1" class="pilcrow">¶</a>
</div>
<div id="chunk-byte-range-start-calculation">
<section id="section-9.5.3.1">
            <h5 id="name-chunk-byte-range-start-calc">
<a href="#section-9.5.3.1" class="section-number selfRef">9.5.3.1. </a><a href="#name-chunk-byte-range-start-calc" class="section-name selfRef">Chunk Byte Range Start Calculation</a>
            </h5>
<p id="section-9.5.3.1-1">The <code>chunk_byte_range_start</code> field is the cumulative byte offset of this chunk within the uncompressed xorb data. It is calculated as the sum of <code>unpacked_segment_bytes</code> for all preceding chunks in the xorb:<a href="#section-9.5.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.5.3.1-2">
<pre>
function calculate_byte_range_starts(chunks):
    position = 0
    for chunk in chunks:
        chunk.byte_range_start = position
        position += chunk.unpacked_segment_bytes
</pre><a href="#section-9.5.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-9.5.3.1-3">Example for a xorb with three chunks:<a href="#section-9.5.3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.5.3.1-4">
<pre>
Chunk 0: unpacked_segment_bytes = 1000
         byte_range_start = 0

Chunk 1: unpacked_segment_bytes = 2000
         byte_range_start = 1000

Chunk 2: unpacked_segment_bytes = 500
         byte_range_start = 3000
</pre><a href="#section-9.5.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-9.5.3.1-5">This field enables efficient seeking within a xorb without decompressing all preceding chunks.<a href="#section-9.5.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chunk-flags">
<section id="section-9.5.3.2">
            <h5 id="name-chunk-flags">
<a href="#section-9.5.3.2" class="section-number selfRef">9.5.3.2. </a><a href="#name-chunk-flags" class="section-name selfRef">Chunk Flags</a>
            </h5>
<table class="center" id="table-5">
              <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Bit</th>
                  <th class="text-left" rowspan="1" colspan="1">Name</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">31</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>GLOBAL_DEDUP_ELIGIBLE</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">Chunk is eligible for global deduplication queries (see <a href="#global-deduplication" class="auto internal xref">Section 10.3</a>)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0-30</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be zero</td>
                </tr>
              </tbody>
            </table>
</section>
</div>
</section>
</div>
<div id="bookend-entry-1">
<section id="section-9.5.4">
          <h4 id="name-bookend-entry-2">
<a href="#section-9.5.4" class="section-number selfRef">9.5.4. </a><a href="#name-bookend-entry-2" class="section-name selfRef">Bookend Entry</a>
          </h4>
<p id="section-9.5.4-1">The CAS info section ends with a 48-byte bookend (same format as file info bookend).<a href="#section-9.5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="shard-footer">
<section id="section-9.6">
        <h3 id="name-footer">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-footer" class="section-name selfRef">Footer</a>
        </h3>
<p id="section-9.6-1">The footer is 200 bytes at the end of the shard. It is <span class="bcp14">REQUIRED</span> for stored shards but <span class="bcp14">MUST</span> be omitted when uploading shards via the upload API.<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.6-2">
<pre>
Offset  Size  Field
------  ----  -----
0       8     Version (64-bit unsigned, MUST be 1)
8       8     File Info Offset (64-bit unsigned)
16      8     CAS Info Offset (64-bit unsigned)
24      8     File Lookup Offset (64-bit unsigned)
32      8     File Lookup Num Entries (64-bit unsigned)
40      8     CAS Lookup Offset (64-bit unsigned)
48      8     CAS Lookup Num Entries (64-bit unsigned)
56      8     Chunk Lookup Offset (64-bit unsigned)
64      8     Chunk Lookup Num Entries (64-bit unsigned)
72      32    Chunk Hash Key
104     8     Shard Creation Timestamp (64-bit unsigned, Unix epoch seconds)
112     8     Shard Key Expiry (64-bit unsigned, Unix epoch seconds)
120     48    Reserved (zeros)
168     8     Stored Bytes on Disk (64-bit unsigned)
176     8     Materialized Bytes (64-bit unsigned)
184     8     Stored Bytes (64-bit unsigned)
192     8     Footer Offset (64-bit unsigned)
</pre><a href="#section-9.6-2" class="pilcrow">¶</a>
</div>
<p id="section-9.6-3">Total size: 200 bytes<a href="#section-9.6-3" class="pilcrow">¶</a></p>
<div id="lookup-tables">
<section id="section-9.6.1">
          <h4 id="name-lookup-tables">
<a href="#section-9.6.1" class="section-number selfRef">9.6.1. </a><a href="#name-lookup-tables" class="section-name selfRef">Lookup Tables</a>
          </h4>
<p id="section-9.6.1-1">Between the CAS info section and the footer, stored shards include lookup tables for efficient searching:<a href="#section-9.6.1-1" class="pilcrow">¶</a></p>
<div id="file-lookup-table">
<section id="section-9.6.1.1">
            <h5 id="name-file-lookup-table">
<a href="#section-9.6.1.1" class="section-number selfRef">9.6.1.1. </a><a href="#name-file-lookup-table" class="section-name selfRef">File Lookup Table</a>
            </h5>
<p id="section-9.6.1.1-1">Located at <code>file_lookup_offset</code>, contains <code>file_lookup_num_entries</code> entries. Each entry is 12 bytes:<a href="#section-9.6.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.6.1.1-2">
<pre>
Offset  Size  Field
------  ----  -----
0       8     Truncated File Hash (64-bit unsigned, first 8 bytes of hash)
8       4     File Info Entry Index (32-bit unsigned)
</pre><a href="#section-9.6.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-9.6.1.1-3">Entries are sorted by truncated hash for binary search.<a href="#section-9.6.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cas-lookup-table">
<section id="section-9.6.1.2">
            <h5 id="name-cas-lookup-table">
<a href="#section-9.6.1.2" class="section-number selfRef">9.6.1.2. </a><a href="#name-cas-lookup-table" class="section-name selfRef">CAS Lookup Table</a>
            </h5>
<p id="section-9.6.1.2-1">Located at <code>cas_lookup_offset</code>, contains <code>cas_lookup_num_entries</code> entries. Each entry is 12 bytes:<a href="#section-9.6.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.6.1.2-2">
<pre>
Offset  Size  Field
------  ----  -----
0       8     Truncated CAS Hash (64-bit unsigned, first 8 bytes of hash)
8       4     CAS Info Entry Index (32-bit unsigned)
</pre><a href="#section-9.6.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-9.6.1.2-3">Entries are sorted by truncated hash for binary search.<a href="#section-9.6.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chunk-lookup-table">
<section id="section-9.6.1.3">
            <h5 id="name-chunk-lookup-table">
<a href="#section-9.6.1.3" class="section-number selfRef">9.6.1.3. </a><a href="#name-chunk-lookup-table" class="section-name selfRef">Chunk Lookup Table</a>
            </h5>
<p id="section-9.6.1.3-1">Located at <code>chunk_lookup_offset</code>, contains <code>chunk_lookup_num_entries</code> entries. Each entry is 16 bytes:<a href="#section-9.6.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.6.1.3-2">
<pre>
Offset  Size  Field
------  ----  -----
0       8     Truncated Chunk Hash (64-bit unsigned, first 8 bytes of hash)
8       4     CAS Entry Index (32-bit unsigned)
12      4     Chunk Index within CAS (32-bit unsigned)
</pre><a href="#section-9.6.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-9.6.1.3-3">Entries are sorted by truncated hash for binary search. When keyed hash protection is enabled, the truncated hash is computed from the keyed chunk hash, not the original.<a href="#section-9.6.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="chunk-hash-key-usage">
<section id="section-9.6.2">
          <h4 id="name-chunk-hash-key-usage">
<a href="#section-9.6.2" class="section-number selfRef">9.6.2. </a><a href="#name-chunk-hash-key-usage" class="section-name selfRef">Chunk Hash Key Usage</a>
          </h4>
<p id="section-9.6.2-1">In global deduplication responses, chunk hashes in the CAS info section are protected with a keyed hash. Clients <span class="bcp14">MUST</span>:<a href="#section-9.6.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.6.2-2">
<li id="section-9.6.2-2.1">
              <p id="section-9.6.2-2.1.1">Compute <code>keyed_hash(footer.chunk_hash_key, their_chunk_hash)</code> for each local chunk<a href="#section-9.6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.6.2-2.2">
              <p id="section-9.6.2-2.2.1">Search for matches in the shard’s CAS info section using the keyed hashes<a href="#section-9.6.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.6.2-2.3">
              <p id="section-9.6.2-2.3.1">Use matched xorb references for deduplication<a href="#section-9.6.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-9.6.2-3">If <code>chunk_hash_key</code> is all zeros, chunk hashes are stored without keyed hash protection.<a href="#section-9.6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="deduplication">
<section id="section-10">
      <h2 id="name-deduplication">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-deduplication" class="section-name selfRef">Deduplication</a>
      </h2>
<p id="section-10-1">XET supports chunk-level deduplication at multiple levels to minimize storage and transfer overhead.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="local-session-deduplication">
<section id="section-10.1">
        <h3 id="name-local-session-deduplication">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-local-session-deduplication" class="section-name selfRef">Local Session Deduplication</a>
        </h3>
<p id="section-10.1-1">Within a single upload session, implementations <span class="bcp14">SHOULD</span> track chunk hashes to avoid processing identical chunks multiple times.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cached-metadata-deduplication">
<section id="section-10.2">
        <h3 id="name-cached-metadata-deduplicati">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-cached-metadata-deduplicati" class="section-name selfRef">Cached Metadata Deduplication</a>
        </h3>
<p id="section-10.2-1">Implementations <span class="bcp14">MAY</span> cache shard metadata locally to enable deduplication against recently uploaded content without network queries.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="global-deduplication">
<section id="section-10.3">
        <h3 id="name-global-deduplication">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-global-deduplication" class="section-name selfRef">Global Deduplication</a>
        </h3>
<p id="section-10.3-1">The global deduplication API enables discovering existing chunks across the entire storage system.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<div id="eligibility-criteria">
<section id="section-10.3.1">
          <h4 id="name-eligibility-criteria">
<a href="#section-10.3.1" class="section-number selfRef">10.3.1. </a><a href="#name-eligibility-criteria" class="section-name selfRef">Eligibility Criteria</a>
          </h4>
<p id="section-10.3.1-1">Not all chunks are eligible for global deduplication queries. A chunk is eligible if:<a href="#section-10.3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3.1-2">
<li id="section-10.3.1-2.1">
              <p id="section-10.3.1-2.1.1">It is the first chunk of a file, OR<a href="#section-10.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.3.1-2.2">
              <p id="section-10.3.1-2.2.1">The last 8 bytes of its hash, interpreted as a little-endian 64-bit unsigned integer, satisfy: <code>value % 1024 == 0</code><a href="#section-10.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="query-process">
<section id="section-10.3.2">
          <h4 id="name-query-process">
<a href="#section-10.3.2" class="section-number selfRef">10.3.2. </a><a href="#name-query-process" class="section-name selfRef">Query Process</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-10.3.2-1">
<li id="section-10.3.2-1.1">
              <p id="section-10.3.2-1.1.1">For eligible chunks, query the global deduplication API (see <a href="#global-dedup-api" class="auto internal xref">Section 11.4</a>).<a href="#section-10.3.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.3.2-1.2">
              <p id="section-10.3.2-1.2.1">On a match, the API returns a shard containing CAS info for xorbs that include the chunk.<a href="#section-10.3.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.3.2-1.3">
              <p id="section-10.3.2-1.3.1">Chunk hashes in the response are protected with a keyed hash; match by computing keyed hashes of local chunk hashes.<a href="#section-10.3.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.3.2-1.4">
              <p id="section-10.3.2-1.4.1">Record matched xorb references for use in file reconstruction terms.<a href="#section-10.3.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="keyed-hash-security">
<section id="section-10.3.3">
          <h4 id="name-keyed-hash-security">
<a href="#section-10.3.3" class="section-number selfRef">10.3.3. </a><a href="#name-keyed-hash-security" class="section-name selfRef">Keyed Hash Security</a>
          </h4>
<p id="section-10.3.3-1">The keyed hash protection ensures that clients can only identify chunks they already possess:<a href="#section-10.3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.3.3-2">
<li id="section-10.3.3-2.1">
              <p id="section-10.3.3-2.1.1">The server never reveals raw chunk hashes to clients.<a href="#section-10.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.3.3-2.2">
              <p id="section-10.3.3-2.2.1">Clients must compute <code>keyed_hash(key, local_hash)</code> to find matches.<a href="#section-10.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.3.3-2.3">
              <p id="section-10.3.3-2.3.1">A match confirms the client has the data, enabling reference to the existing xorb.<a href="#section-10.3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="fragmentation-prevention">
<section id="section-10.4">
        <h3 id="name-fragmentation-prevention">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-fragmentation-prevention" class="section-name selfRef">Fragmentation Prevention</a>
        </h3>
<p id="section-10.4-1">Aggressive deduplication can fragment files across many xorbs, harming read performance. Implementations <span class="bcp14">SHOULD</span>:<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.4-2.1">
            <p id="section-10.4-2.1.1">Prefer longer contiguous chunk ranges over maximum deduplication<a href="#section-10.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.2">
            <p id="section-10.4-2.2.1">Target minimum run lengths (e.g., 8 chunks or 1 MiB) before accepting deduplicated references<a href="#section-10.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="cas-api">
<section id="section-11">
      <h2 id="name-cas-api">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-cas-api" class="section-name selfRef">CAS API</a>
      </h2>
<p id="section-11-1">The CAS (Content Addressable Storage) API provides HTTP endpoints for upload and download operations.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="authentication">
<section id="section-11.1">
        <h3 id="name-authentication">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-authentication" class="section-name selfRef">Authentication</a>
        </h3>
<p id="section-11.1-1">All API requests require authentication via Bearer token in the Authorization header:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.1-2">
<pre>
Authorization: Bearer &lt;access_token&gt;
</pre><a href="#section-11.1-2" class="pilcrow">¶</a>
</div>
<p id="section-11.1-3">Tokens have associated scopes:<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-4.1">
            <p id="section-11.1-4.1.1"><code>read</code>: Required for reconstruction and global deduplication queries<a href="#section-11.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.1-4.2">
            <p id="section-11.1-4.2.1"><code>write</code>: Required for xorb and shard uploads (includes <code>read</code> permissions)<a href="#section-11.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.1-5">Token acquisition is provider-specific and outside the scope of this specification.<a href="#section-11.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="common-headers">
<section id="section-11.2">
        <h3 id="name-common-headers">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-common-headers" class="section-name selfRef">Common Headers</a>
        </h3>
<p id="section-11.2-1">Request headers:<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-2.1">
            <p id="section-11.2-2.1.1"><code>Authorization</code>: Bearer token (required)<a href="#section-11.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-2.2">
            <p id="section-11.2-2.2.1"><code>Content-Type</code>: <code>application/octet-stream</code> for binary uploads<a href="#section-11.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-2.3">
            <p id="section-11.2-2.3.1"><code>Range</code>: Byte range for partial requests (optional)<a href="#section-11.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.2-3">Response headers:<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-4.1">
            <p id="section-11.2-4.1.1"><code>Content-Type</code>: <code>application/json</code> or <code>application/octet-stream</code><a href="#section-11.2-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="reconstruction-api">
<section id="section-11.3">
        <h3 id="name-get-file-reconstruction">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-get-file-reconstruction" class="section-name selfRef">Get File Reconstruction</a>
        </h3>
<p id="section-11.3-1">Retrieves reconstruction information for downloading a file.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.3-2">
<pre>
GET /v1/reconstructions/{file_id}
</pre><a href="#section-11.3-2" class="pilcrow">¶</a>
</div>
<p id="section-11.3-3">Path Parameters:<a href="#section-11.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-4.1">
            <p id="section-11.3-4.1.1"><code>file_id</code>: File hash as hex string (see <a href="#hash-string-format" class="auto internal xref">Section 6.5</a>)<a href="#section-11.3-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.3-5">Optional Headers:<a href="#section-11.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-6.1">
            <p id="section-11.3-6.1.1"><code>Range: bytes={start}-{end}</code>: Request specific byte range (end inclusive)<a href="#section-11.3-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.3-7">Response (<code>200 OK</code>):<a href="#section-11.3-7" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-11.3-8">
<pre>
{
  "offset_into_first_range": 0,
  "terms": [
    {
      "hash": "&lt;xorb_hash_hex&gt;",
      "unpacked_length": 263873,
      "range": {
        "start": 0,
        "end": 4
      }
    }
  ],
  "fetch_info": {
    "&lt;xorb_hash_hex&gt;": [
      {
        "range": {
          "start": 0,
          "end": 4
        },
        "url": "https://...",
        "url_range": {
          "start": 0,
          "end": 131071
        }
      }
    ]
  }
}
</pre><a href="#section-11.3-8" class="pilcrow">¶</a>
</div>
<p id="section-11.3-9">Response Fields:<a href="#section-11.3-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-10.1">
            <p id="section-11.3-10.1.1"><code>offset_into_first_range</code>: Bytes to skip in first term (for range queries)<a href="#section-11.3-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-10.2">
            <p id="section-11.3-10.2.1"><code>terms</code>: Ordered list of reconstruction terms<a href="#section-11.3-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-10.3">
            <p id="section-11.3-10.3.1"><code>fetch_info</code>: Map from xorb hash to fetch information<a href="#section-11.3-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.3-11">Fetch Info Fields:<a href="#section-11.3-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-12.1">
            <p id="section-11.3-12.1.1"><code>range</code>: Chunk index range this entry covers<a href="#section-11.3-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-12.2">
            <p id="section-11.3-12.2.1"><code>url</code>: Pre-signed URL for downloading xorb data<a href="#section-11.3-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-12.3">
            <p id="section-11.3-12.3.1"><code>url_range</code>: Byte range within the xorb for HTTP <code>Range</code> header (end inclusive). The start offset is always aligned to a chunk header boundary, so clients can parse chunk headers sequentially from the start of the fetched data.<a href="#section-11.3-12.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.3-13">Error Responses:<a href="#section-11.3-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-14.1">
            <p id="section-11.3-14.1.1"><code>400 Bad Request</code>: Invalid <code>file_id</code> format<a href="#section-11.3-14.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-14.2">
            <p id="section-11.3-14.2.1"><code>401 Unauthorized</code>: Invalid or expired token<a href="#section-11.3-14.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-14.3">
            <p id="section-11.3-14.3.1"><code>404 Not Found</code>: File does not exist<a href="#section-11.3-14.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-14.4">
            <p id="section-11.3-14.4.1"><code>416 Range Not Satisfiable</code>: Invalid byte range<a href="#section-11.3-14.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="global-dedup-api">
<section id="section-11.4">
        <h3 id="name-query-chunk-deduplication">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-query-chunk-deduplication" class="section-name selfRef">Query Chunk Deduplication</a>
        </h3>
<p id="section-11.4-1">Checks if a chunk exists in the system for deduplication.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.4-2">
<pre>
GET /v1/chunks/default-merkledb/{chunk_hash}
</pre><a href="#section-11.4-2" class="pilcrow">¶</a>
</div>
<p id="section-11.4-3">Path Parameters:<a href="#section-11.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.4-4.1">
            <p id="section-11.4-4.1.1"><code>chunk_hash</code>: Chunk hash as hex string (see <a href="#hash-string-format" class="auto internal xref">Section 6.5</a>)<a href="#section-11.4-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.4-5">Response (<code>200 OK</code>): Shard format binary (see <a href="#shard-format" class="auto internal xref">Section 9</a>)<a href="#section-11.4-5" class="pilcrow">¶</a></p>
<p id="section-11.4-6">Response (<code>404 Not Found</code>): Chunk not tracked by global deduplication<a href="#section-11.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upload-xorb">
<section id="section-11.5">
        <h3 id="name-upload-xorb">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-upload-xorb" class="section-name selfRef">Upload Xorb</a>
        </h3>
<p id="section-11.5-1">Uploads a serialized xorb to storage.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.5-2">
<pre>
POST /v1/xorbs/default/{xorb_hash}
</pre><a href="#section-11.5-2" class="pilcrow">¶</a>
</div>
<p id="section-11.5-3">Path Parameters:<a href="#section-11.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-4.1">
            <p id="section-11.5-4.1.1"><code>xorb_hash</code>: Xorb hash as hex string (see <a href="#hash-string-format" class="auto internal xref">Section 6.5</a>)<a href="#section-11.5-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.5-5">Request Body: Serialized xorb (binary, see <a href="#xorb-format" class="auto internal xref">Section 7</a>)<a href="#section-11.5-5" class="pilcrow">¶</a></p>
<p id="section-11.5-6">Response (<code>200 OK</code>):<a href="#section-11.5-6" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-11.5-7">
<pre>
{
  "was_inserted": true
}
</pre><a href="#section-11.5-7" class="pilcrow">¶</a>
</div>
<p id="section-11.5-8">The <code>was_inserted</code> field is <code>false</code> if the xorb already existed; this is not an error.<a href="#section-11.5-8" class="pilcrow">¶</a></p>
<p id="section-11.5-9">Error Responses:<a href="#section-11.5-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.5-10.1">
            <p id="section-11.5-10.1.1"><code>400 Bad Request</code>: Hash mismatch or invalid xorb format<a href="#section-11.5-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.5-10.2">
            <p id="section-11.5-10.2.1"><code>401 Unauthorized</code>: Invalid or expired token<a href="#section-11.5-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.5-10.3">
            <p id="section-11.5-10.3.1"><code>403 Forbidden</code>: Insufficient token scope<a href="#section-11.5-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="upload-shard">
<section id="section-11.6">
        <h3 id="name-upload-shard">
<a href="#section-11.6" class="section-number selfRef">11.6. </a><a href="#name-upload-shard" class="section-name selfRef">Upload Shard</a>
        </h3>
<p id="section-11.6-1">Uploads a shard to register files in the system.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.6-2">
<pre>
POST /v1/shards
</pre><a href="#section-11.6-2" class="pilcrow">¶</a>
</div>
<p id="section-11.6-3">Request Body: Serialized shard without footer (binary, see <a href="#shard-format" class="auto internal xref">Section 9</a>)<a href="#section-11.6-3" class="pilcrow">¶</a></p>
<p id="section-11.6-4">Response (<code>200 OK</code>):<a href="#section-11.6-4" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-11.6-5">
<pre>
{
  "result": 0
}
</pre><a href="#section-11.6-5" class="pilcrow">¶</a>
</div>
<p id="section-11.6-6">Result values:<a href="#section-11.6-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.6-7.1">
            <p id="section-11.6-7.1.1"><code>0</code>: Shard already exists<a href="#section-11.6-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.6-7.2">
            <p id="section-11.6-7.2.1"><code>1</code>: Shard was registered<a href="#section-11.6-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.6-8">Error Responses:<a href="#section-11.6-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.6-9.1">
            <p id="section-11.6-9.1.1"><code>400 Bad Request</code>: Invalid shard format or referenced xorb missing<a href="#section-11.6-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.6-9.2">
            <p id="section-11.6-9.2.1"><code>401 Unauthorized</code>: Invalid or expired token<a href="#section-11.6-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.6-9.3">
            <p id="section-11.6-9.3.1"><code>403 Forbidden</code>: Insufficient token scope<a href="#section-11.6-9.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="upload-protocol">
<section id="section-12">
      <h2 id="name-upload-protocol">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-upload-protocol" class="section-name selfRef">Upload Protocol</a>
      </h2>
<p id="section-12-1">This section describes the complete procedure for uploading files.<a href="#section-12-1" class="pilcrow">¶</a></p>
<div id="step-1-chunking">
<section id="section-12.1">
        <h3 id="name-step-1-chunking">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-step-1-chunking" class="section-name selfRef">Step 1: Chunking</a>
        </h3>
<p id="section-12.1-1">Split each file into chunks using the algorithm in <a href="#content-defined-chunking" class="auto internal xref">Section 5</a>.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">For each chunk:<a href="#section-12.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.1-3">
<li id="section-12.1-3.1">
            <p id="section-12.1-3.1.1">Compute the chunk hash (see <a href="#chunk-hashes" class="auto internal xref">Section 6.1</a>)<a href="#section-12.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.1-3.2">
            <p id="section-12.1-3.2.1">Record the chunk data, hash, and size<a href="#section-12.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="step-2-deduplication">
<section id="section-12.2">
        <h3 id="name-step-2-deduplication">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-step-2-deduplication" class="section-name selfRef">Step 2: Deduplication</a>
        </h3>
<p id="section-12.2-1">For each chunk, attempt deduplication in order:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.2-2">
<li id="section-12.2-2.1">
            <p id="section-12.2-2.1.1">Local Session: Check if chunk hash was seen earlier in this session<a href="#section-12.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.2-2.2">
            <p id="section-12.2-2.2.1">Cached Metadata: Check local shard cache for chunk hash<a href="#section-12.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.2-2.3">
            <p id="section-12.2-2.3.1">Global API: For eligible chunks, query the global deduplication API<a href="#section-12.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-12.2-3">Record deduplication results:<a href="#section-12.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-4.1">
            <p id="section-12.2-4.1.1">New chunks: Will be included in xorbs<a href="#section-12.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-4.2">
            <p id="section-12.2-4.2.1">Deduplicated chunks: Record existing xorb hash and chunk index<a href="#section-12.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="step-3-xorb-formation">
<section id="section-12.3">
        <h3 id="name-step-3-xorb-formation">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-step-3-xorb-formation" class="section-name selfRef">Step 3: Xorb Formation</a>
        </h3>
<p id="section-12.3-1">Group new (non-deduplicated) chunks into xorbs:<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.3-2">
<li id="section-12.3-2.1">
            <p id="section-12.3-2.1.1">Collect chunks maintaining their order within files<a href="#section-12.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.3-2.2">
            <p id="section-12.3-2.2.1">Form xorbs targeting ~64 MiB total size<a href="#section-12.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.3-2.3">
            <p id="section-12.3-2.3.1">Compute compression for each chunk<a href="#section-12.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.3-2.4">
            <p id="section-12.3-2.4.1">Compute xorb hash for each xorb (see <a href="#xorb-hashes" class="auto internal xref">Section 6.2</a>)<a href="#section-12.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="step-4-xorb-serialization-and-upload">
<section id="section-12.4">
        <h3 id="name-step-4-xorb-serialization-a">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-step-4-xorb-serialization-a" class="section-name selfRef">Step 4: Xorb Serialization and Upload</a>
        </h3>
<p id="section-12.4-1">For each new xorb:<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.4-2">
<li id="section-12.4-2.1">
            <p id="section-12.4-2.1.1">Serialize using the format in <a href="#xorb-format" class="auto internal xref">Section 7</a><a href="#section-12.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.4-2.2">
            <p id="section-12.4-2.2.1">Upload via <code>POST</code> to <code>/v1/xorbs/default/{xorb_hash}</code><a href="#section-12.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.4-2.3">
            <p id="section-12.4-2.3.1">Verify successful response<a href="#section-12.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-12.4-3">All xorbs <span class="bcp14">MUST</span> be uploaded before proceeding to shard upload.<a href="#section-12.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="step-5-shard-formation">
<section id="section-12.5">
        <h3 id="name-step-5-shard-formation">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-step-5-shard-formation" class="section-name selfRef">Step 5: Shard Formation</a>
        </h3>
<p id="section-12.5-1">Build the shard structure:<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.5-2">
<li id="section-12.5-2.1">
            <p id="section-12.5-2.1.1">For each file, construct file reconstruction terms<a href="#section-12.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.5-2.2">
            <p id="section-12.5-2.2.1">Compute verification hashes for each term (see <a href="#verification-hashes" class="auto internal xref">Section 6.4</a>)<a href="#section-12.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.5-2.3">
            <p id="section-12.5-2.3.1">Compute file hash (see <a href="#file-hashes" class="auto internal xref">Section 6.3</a>)<a href="#section-12.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.5-2.4">
            <p id="section-12.5-2.4.1">Compute SHA-256 of raw file contents<a href="#section-12.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.5-2.5">
            <p id="section-12.5-2.5.1">Build CAS info blocks for new xorbs<a href="#section-12.5-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="step-6-shard-upload">
<section id="section-12.6">
        <h3 id="name-step-6-shard-upload">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-step-6-shard-upload" class="section-name selfRef">Step 6: Shard Upload</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-12.6-1">
<li id="section-12.6-1.1">
            <p id="section-12.6-1.1.1">Serialize the shard without footer<a href="#section-12.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.6-1.2">
            <p id="section-12.6-1.2.1">Upload via <code>POST</code> to <code>/v1/shards</code><a href="#section-12.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.6-1.3">
            <p id="section-12.6-1.3.1">Verify successful response<a href="#section-12.6-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="ordering-and-concurrency">
<section id="section-12.7">
        <h3 id="name-ordering-and-concurrency">
<a href="#section-12.7" class="section-number selfRef">12.7. </a><a href="#name-ordering-and-concurrency" class="section-name selfRef">Ordering and Concurrency</a>
        </h3>
<p id="section-12.7-1">The following ordering constraints apply:<a href="#section-12.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.7-2.1">
            <p id="section-12.7-2.1.1">All xorbs referenced by a shard <span class="bcp14">MUST</span> be uploaded before the shard<a href="#section-12.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.7-2.2">
            <p id="section-12.7-2.2.1">Chunk computation for a file must complete before xorb formation<a href="#section-12.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.7-2.3">
            <p id="section-12.7-2.3.1">Xorb hash computation must complete before shard formation<a href="#section-12.7-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.7-3">Within these constraints, operations <span class="bcp14">MAY</span> be parallelized:<a href="#section-12.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.7-4.1">
            <p id="section-12.7-4.1.1">Multiple files can be chunked concurrently<a href="#section-12.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.7-4.2">
            <p id="section-12.7-4.2.1">Multiple xorbs can be uploaded concurrently<a href="#section-12.7-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.7-4.3">
            <p id="section-12.7-4.3.1">Deduplication queries can run in parallel<a href="#section-12.7-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="download-protocol">
<section id="section-13">
      <h2 id="name-download-protocol">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-download-protocol" class="section-name selfRef">Download Protocol</a>
      </h2>
<p id="section-13-1">This section describes the complete procedure for downloading files.<a href="#section-13-1" class="pilcrow">¶</a></p>
<div id="step-1-query-reconstruction">
<section id="section-13.1">
        <h3 id="name-step-1-query-reconstruction">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-step-1-query-reconstruction" class="section-name selfRef">Step 1: Query Reconstruction</a>
        </h3>
<p id="section-13.1-1">Request reconstruction information:<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.1-2">
<pre>
GET /v1/reconstructions/{file_id}
Authorization: Bearer &lt;token&gt;
</pre><a href="#section-13.1-2" class="pilcrow">¶</a>
</div>
<p id="section-13.1-3">For range queries, include the <code>Range</code> header:<a href="#section-13.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.1-4">
<pre>
Range: bytes=0-1048575
</pre><a href="#section-13.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="step-2-parse-response">
<section id="section-13.2">
        <h3 id="name-step-2-parse-response">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-step-2-parse-response" class="section-name selfRef">Step 2: Parse Response</a>
        </h3>
<p id="section-13.2-1">Extract from the response:<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-2.1">
            <p id="section-13.2-2.1.1"><code>offset_into_first_range</code>: Bytes to skip in first term<a href="#section-13.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.2-2.2">
            <p id="section-13.2-2.2.1"><code>terms</code>: Ordered list of terms to process<a href="#section-13.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.2-2.3">
            <p id="section-13.2-2.3.1"><code>fetch_info</code>: URLs and ranges for downloading data<a href="#section-13.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="step-3-download-xorb-data">
<section id="section-13.3">
        <h3 id="name-step-3-download-xorb-data">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-step-3-download-xorb-data" class="section-name selfRef">Step 3: Download Xorb Data</a>
        </h3>
<p id="section-13.3-1">For each term:<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.3-2">
<li id="section-13.3-2.1">
            <p id="section-13.3-2.1.1">Look up <code>fetch_info</code> by xorb hash<a href="#section-13.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.3-2.2">
            <p id="section-13.3-2.2.1">Find <code>fetch_info</code> entry covering the term’s chunk range<a href="#section-13.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.3-2.3">
            <p id="section-13.3-2.3.1">Make HTTP <code>GET</code> request to the URL with <code>Range</code> header<a href="#section-13.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.3-2.4">
            <p id="section-13.3-2.4.1">Download the xorb byte range<a href="#section-13.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-13.3-3">Multiple terms may share <code>fetch_info</code> entries; implementations <span class="bcp14">SHOULD</span> avoid redundant downloads.<a href="#section-13.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="step-4-extract-chunks">
<section id="section-13.4">
        <h3 id="name-step-4-extract-chunks">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-step-4-extract-chunks" class="section-name selfRef">Step 4: Extract Chunks</a>
        </h3>
<p id="section-13.4-1">For each downloaded xorb range:<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-13.4-2">
<li id="section-13.4-2.1">
            <p id="section-13.4-2.1.1">Parse chunk headers sequentially<a href="#section-13.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.4-2.2">
            <p id="section-13.4-2.2.1">Decompress chunk data according to compression type<a href="#section-13.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.4-2.3">
            <p id="section-13.4-2.3.1">Extract chunks for the term’s index range<a href="#section-13.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="step-5-assemble-file">
<section id="section-13.5">
        <h3 id="name-step-5-assemble-file">
<a href="#section-13.5" class="section-number selfRef">13.5. </a><a href="#name-step-5-assemble-file" class="section-name selfRef">Step 5: Assemble File</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-13.5-1">
<li id="section-13.5-1.1">
            <p id="section-13.5-1.1.1">For the first term, skip <code>offset_into_first_range</code> bytes<a href="#section-13.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.5-1.2">
            <p id="section-13.5-1.2.1">Concatenate extracted chunks in term order<a href="#section-13.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.5-1.3">
            <p id="section-13.5-1.3.1">For range queries, truncate to requested length<a href="#section-13.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-13.5-1.4">
            <p id="section-13.5-1.4.1">Write to output file or buffer<a href="#section-13.5-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="caching-recommendations">
<section id="section-13.6">
        <h3 id="name-caching-recommendations">
<a href="#section-13.6" class="section-number selfRef">13.6. </a><a href="#name-caching-recommendations" class="section-name selfRef">Caching Recommendations</a>
        </h3>
<p id="section-13.6-1">See <a href="#caching-considerations" class="auto internal xref">Section 14</a> for comprehensive caching guidance. Key recommendations:<a href="#section-13.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.6-2.1">
            <p id="section-13.6-2.1.1">Cache decompressed chunks by hash for reuse across files and sessions<a href="#section-13.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.6-2.2">
            <p id="section-13.6-2.2.1">Avoid caching reconstruction API responses (pre-signed URLs expire quickly)<a href="#section-13.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.6-2.3">
            <p id="section-13.6-2.3.1">Cache shard metadata for local deduplication during uploads<a href="#section-13.6-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="error-handling">
<section id="section-13.7">
        <h3 id="name-error-handling">
<a href="#section-13.7" class="section-number selfRef">13.7. </a><a href="#name-error-handling" class="section-name selfRef">Error Handling</a>
        </h3>
<p id="section-13.7-1">Implementations <span class="bcp14">SHOULD</span> implement:<a href="#section-13.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.7-2.1">
            <p id="section-13.7-2.1.1">Retry logic with exponential backoff for transient failures<a href="#section-13.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.7-2.2">
            <p id="section-13.7-2.2.1">Validation of decompressed chunk sizes against headers<a href="#section-13.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.7-2.3">
            <p id="section-13.7-2.3.1">Hash verification of reconstructed files when possible<a href="#section-13.7-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="caching-considerations">
<section id="section-14">
      <h2 id="name-caching-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-caching-considerations" class="section-name selfRef">Caching Considerations</a>
      </h2>
<p id="section-14-1">XET’s content-addressable design enables effective caching at multiple levels. This section provides guidance for implementers on caching strategies and considerations.<a href="#section-14-1" class="pilcrow">¶</a></p>
<div id="content-immutability">
<section id="section-14.1">
        <h3 id="name-content-immutability">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-content-immutability" class="section-name selfRef">Content Immutability</a>
        </h3>
<p id="section-14.1-1">Objects in XET are identified by cryptographic hashes of their content. This content-addressable design provides a fundamental property: content at a given hash never changes. A xorb with hash H will always contain the same bytes, and a chunk with hash C will always decompress to the same data.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<p id="section-14.1-2">This immutability enables aggressive caching:<a href="#section-14.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.1-3.1">
            <p id="section-14.1-3.1.1">Cached xorb data never becomes stale<a href="#section-14.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-3.2">
            <p id="section-14.1-3.2.1">Cached chunk data can be reused indefinitely<a href="#section-14.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-3.3">
            <p id="section-14.1-3.3.1">Cache invalidation is never required for content objects<a href="#section-14.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.1-4">The only time-sensitive elements are authentication tokens and pre-signed URLs, which are discussed separately below.<a href="#section-14.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-side-chunk-caching">
<section id="section-14.2">
        <h3 id="name-client-side-chunk-caching">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-client-side-chunk-caching" class="section-name selfRef">Client-Side Chunk Caching</a>
        </h3>
<p id="section-14.2-1">Implementations <span class="bcp14">SHOULD</span> cache decompressed chunk data to avoid redundant decompression and network requests. The chunk hash provides a natural cache key.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<div id="cache-key-design">
<section id="section-14.2.1">
          <h4 id="name-cache-key-design">
<a href="#section-14.2.1" class="section-number selfRef">14.2.1. </a><a href="#name-cache-key-design" class="section-name selfRef">Cache Key Design</a>
          </h4>
<p id="section-14.2.1-1">Chunk caches <span class="bcp14">SHOULD</span> use the chunk hash (32 bytes or its string representation) as the cache key. Since hashes uniquely identify content, there is no risk of cache collisions or stale data.<a href="#section-14.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cache-granularity">
<section id="section-14.2.2">
          <h4 id="name-cache-granularity">
<a href="#section-14.2.2" class="section-number selfRef">14.2.2. </a><a href="#name-cache-granularity" class="section-name selfRef">Cache Granularity</a>
          </h4>
<p id="section-14.2.2-1">Implementations <span class="bcp14">MAY</span> cache at different granularities:<a href="#section-14.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.2.2-2.1">
              <p id="section-14.2.2-2.1.1">Individual chunks: Fine-grained, maximizes deduplication benefit<a href="#section-14.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.2-2.2">
              <p id="section-14.2.2-2.2.1">Chunk ranges: Coarser-grained, reduces metadata overhead<a href="#section-14.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.2-2.3">
              <p id="section-14.2.2-2.3.1">Complete xorbs: Simplest, but may cache unused chunks<a href="#section-14.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-14.2.2-3">For most workloads, caching individual chunks by hash provides the best balance of storage efficiency and hit rate.<a href="#section-14.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eviction-strategies">
<section id="section-14.2.3">
          <h4 id="name-eviction-strategies">
<a href="#section-14.2.3" class="section-number selfRef">14.2.3. </a><a href="#name-eviction-strategies" class="section-name selfRef">Eviction Strategies</a>
          </h4>
<p id="section-14.2.3-1">Since all cached content remains valid indefinitely, eviction is based purely on resource constraints:<a href="#section-14.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.2.3-2.1">
              <p id="section-14.2.3-2.1.1">LRU (Least Recently Used): Effective for workloads with temporal locality<a href="#section-14.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.3-2.2">
              <p id="section-14.2.3-2.2.1">LFU (Least Frequently Used): Effective for workloads with stable hot sets<a href="#section-14.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.3-2.3">
              <p id="section-14.2.3-2.3.1">Size-aware LRU: Prioritizes keeping smaller chunks that are cheaper to re-fetch<a href="#section-14.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-14.2.3-3">Implementations <span class="bcp14">SHOULD</span> track cache size and implement eviction when storage limits are reached.<a href="#section-14.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="xorb-data-caching">
<section id="section-14.3">
        <h3 id="name-xorb-data-caching">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-xorb-data-caching" class="section-name selfRef">Xorb Data Caching</a>
        </h3>
<p id="section-14.3-1">Raw xorb data (compressed chunks with headers) <span class="bcp14">MAY</span> be cached by clients or intermediaries.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<div id="client-side-xorb-cache">
<section id="section-14.3.1">
          <h4 id="name-client-side-xorb-cache">
<a href="#section-14.3.1" class="section-number selfRef">14.3.1. </a><a href="#name-client-side-xorb-cache" class="section-name selfRef">Client-Side Xorb Cache</a>
          </h4>
<p id="section-14.3.1-1">Caching raw xorb byte ranges avoids repeated downloads but requires decompression on each use. This trades storage for bandwidth. Implementations <span class="bcp14">SHOULD</span> prefer caching decompressed chunks unless bandwidth is severely constrained.<a href="#section-14.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="byte-range-considerations">
<section id="section-14.3.2">
          <h4 id="name-byte-range-considerations">
<a href="#section-14.3.2" class="section-number selfRef">14.3.2. </a><a href="#name-byte-range-considerations" class="section-name selfRef">Byte Range Considerations</a>
          </h4>
<p id="section-14.3.2-1">When caching partial xorb downloads (byte ranges), implementations <span class="bcp14">SHOULD</span>:<a href="#section-14.3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-14.3.2-2">
<li id="section-14.3.2-2.1">
              <p id="section-14.3.2-2.1.1">Cache at chunk-header-aligned boundaries to enable independent chunk extraction<a href="#section-14.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-14.3.2-2.2">
              <p id="section-14.3.2-2.2.1">Track which byte ranges are cached for each xorb hash<a href="#section-14.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-14.3.2-2.3">
              <p id="section-14.3.2-2.3.1">Coalesce adjacent cached ranges when possible<a href="#section-14.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="shard-metadata-caching">
<section id="section-14.4">
        <h3 id="name-shard-metadata-caching">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-shard-metadata-caching" class="section-name selfRef">Shard Metadata Caching</a>
        </h3>
<p id="section-14.4-1">Shard metadata enables deduplication without network queries. Implementations <span class="bcp14">SHOULD</span> cache shards from recent uploads for local deduplication.<a href="#section-14.4-1" class="pilcrow">¶</a></p>
<div id="cache-lifetime">
<section id="section-14.4.1">
          <h4 id="name-cache-lifetime">
<a href="#section-14.4.1" class="section-number selfRef">14.4.1. </a><a href="#name-cache-lifetime" class="section-name selfRef">Cache Lifetime</a>
          </h4>
<p id="section-14.4.1-1">Unlike content objects, shard metadata has implicit lifetime constraints:<a href="#section-14.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.4.1-2.1">
              <p id="section-14.4.1-2.1.1">Global deduplication responses include a <code>chunk_hash_key</code> that rotates periodically<a href="#section-14.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-2.2">
              <p id="section-14.4.1-2.2.1">The <code>shard_key_expiry</code> field in the footer indicates when the key expires<a href="#section-14.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-2.3">
              <p id="section-14.4.1-2.3.1">After expiry, keyed hash matches will fail<a href="#section-14.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-14.4.1-3">Implementations <span class="bcp14">SHOULD</span> evict cached deduplication shards when their keys expire.<a href="#section-14.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cache-size">
<section id="section-14.4.2">
          <h4 id="name-cache-size">
<a href="#section-14.4.2" class="section-number selfRef">14.4.2. </a><a href="#name-cache-size" class="section-name selfRef">Cache Size</a>
          </h4>
<p id="section-14.4.2-1">Shard metadata is relatively compact (typically under 1 MiB per upload session). Implementations <span class="bcp14">MAY</span> cache several hundred recent shards without significant storage impact.<a href="#section-14.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pre-signed-url-handling">
<section id="section-14.5">
        <h3 id="name-pre-signed-url-handling">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-pre-signed-url-handling" class="section-name selfRef">Pre-Signed URL Handling</a>
        </h3>
<p id="section-14.5-1">The reconstruction API returns pre-signed URLs for downloading xorb data. These URLs have short expiration times (typically minutes to hours) and <span class="bcp14">MUST NOT</span> be cached beyond their validity period.<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<p id="section-14.5-2">Implementations <span class="bcp14">MUST</span>:<a href="#section-14.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.5-3.1">
            <p id="section-14.5-3.1.1">Use URLs promptly after receiving them<a href="#section-14.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.5-3.2">
            <p id="section-14.5-3.2.1">Re-query the reconstruction API if URLs have expired<a href="#section-14.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.5-3.3">
            <p id="section-14.5-3.3.1">Never persist URLs to disk for later sessions<a href="#section-14.5-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.5-4">Reconstruction responses <span class="bcp14">SHOULD</span> be treated as ephemeral and re-fetched when needed rather than cached.<a href="#section-14.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-caching-headers">
<section id="section-14.6">
        <h3 id="name-http-caching-headers">
<a href="#section-14.6" class="section-number selfRef">14.6. </a><a href="#name-http-caching-headers" class="section-name selfRef">HTTP Caching Headers</a>
        </h3>
<div id="server-recommendations">
<section id="section-14.6.1">
          <h4 id="name-server-recommendations">
<a href="#section-14.6.1" class="section-number selfRef">14.6.1. </a><a href="#name-server-recommendations" class="section-name selfRef">Server Recommendations</a>
          </h4>
<p id="section-14.6.1-1">CAS servers <span class="bcp14">SHOULD</span> return appropriate HTTP caching headers for xorb downloads:<a href="#section-14.6.1-1" class="pilcrow">¶</a></p>
<p id="section-14.6.1-2">For xorb content (immutable):<a href="#section-14.6.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-14.6.1-3">
<pre>
Cache-Control: public, max-age=31536000, immutable
ETag: "&lt;xorb_hash&gt;"
</pre><a href="#section-14.6.1-3" class="pilcrow">¶</a>
</div>
<p id="section-14.6.1-4">The <code>immutable</code> directive indicates the content will never change, allowing caches to skip revalidation entirely.<a href="#section-14.6.1-4" class="pilcrow">¶</a></p>
<p id="section-14.6.1-5">For reconstruction API responses (ephemeral):<a href="#section-14.6.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-14.6.1-6">
<pre>
Cache-Control: private, no-store
</pre><a href="#section-14.6.1-6" class="pilcrow">¶</a>
</div>
<p id="section-14.6.1-7">Reconstruction responses contain pre-signed URLs that expire and <span class="bcp14">MUST NOT</span> be cached by intermediaries.<a href="#section-14.6.1-7" class="pilcrow">¶</a></p>
<p id="section-14.6.1-8">For global deduplication responses:<a href="#section-14.6.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-14.6.1-9">
<pre>
Cache-Control: private, max-age=3600
Vary: Authorization
</pre><a href="#section-14.6.1-9" class="pilcrow">¶</a>
</div>
<p id="section-14.6.1-10">Deduplication responses are user-specific and may be cached briefly by the client.<a href="#section-14.6.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-recommendations">
<section id="section-14.6.2">
          <h4 id="name-client-recommendations">
<a href="#section-14.6.2" class="section-number selfRef">14.6.2. </a><a href="#name-client-recommendations" class="section-name selfRef">Client Recommendations</a>
          </h4>
<p id="section-14.6.2-1">Clients <span class="bcp14">SHOULD</span> respect <code>Cache-Control</code> headers from servers. When downloading xorb data, clients <span class="bcp14">MAY</span> cache responses locally even if no caching headers are present, since content-addressed data is inherently immutable.<a href="#section-14.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cdn-integration">
<section id="section-14.7">
        <h3 id="name-cdn-integration">
<a href="#section-14.7" class="section-number selfRef">14.7. </a><a href="#name-cdn-integration" class="section-name selfRef">CDN Integration</a>
        </h3>
<p id="section-14.7-1">XET deployments typically serve xorb data through CDNs. The content-addressable design is well-suited for CDN caching:<a href="#section-14.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.7-2.1">
            <p id="section-14.7-2.1.1">Hash-based URLs enable cache key stability<a href="#section-14.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-2.2">
            <p id="section-14.7-2.2.1">Immutable content eliminates cache invalidation complexity<a href="#section-14.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-2.3">
            <p id="section-14.7-2.3.1">Range requests enable partial caching of large xorbs<a href="#section-14.7-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="cdn-cache-keys">
<section id="section-14.7.1">
          <h4 id="name-cdn-cache-keys">
<a href="#section-14.7.1" class="section-number selfRef">14.7.1. </a><a href="#name-cdn-cache-keys" class="section-name selfRef">CDN Cache Keys</a>
          </h4>
<p id="section-14.7.1-1">CDN cache keys <span class="bcp14">SHOULD</span> include:<a href="#section-14.7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.7.1-2.1">
              <p id="section-14.7.1-2.1.1">The xorb hash (from the URL path)<a href="#section-14.7.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.7.1-2.2">
              <p id="section-14.7.1-2.2.1">The byte range (if Range header is present)<a href="#section-14.7.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-14.7.1-3">CDN cache keys <span class="bcp14">SHOULD NOT</span> include:<a href="#section-14.7.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.7.1-4.1">
              <p id="section-14.7.1-4.1.1">Authorization headers (these vary per user but content is identical)<a href="#section-14.7.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.7.1-4.2">
              <p id="section-14.7.1-4.2.1">Query string parameters for pre-signed URLs (these vary but content is identical)<a href="#section-14.7.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="range-request-caching">
<section id="section-14.7.2">
          <h4 id="name-range-request-caching">
<a href="#section-14.7.2" class="section-number selfRef">14.7.2. </a><a href="#name-range-request-caching" class="section-name selfRef">Range Request Caching</a>
          </h4>
<p id="section-14.7.2-1">CDNs <span class="bcp14">SHOULD</span> cache partial responses (<code>206 Partial Content</code>) by byte range. When a subsequent request covers a cached range, the CDN can serve from cache without contacting the origin.<a href="#section-14.7.2-1" class="pilcrow">¶</a></p>
<p id="section-14.7.2-2">Some CDNs support range coalescing, where multiple partial caches are combined to serve larger requests. This is particularly effective for XET where different users may request different chunk ranges from the same xorb.<a href="#section-14.7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="proxy-and-intermediary-considerations">
<section id="section-14.8">
        <h3 id="name-proxy-and-intermediary-cons">
<a href="#section-14.8" class="section-number selfRef">14.8. </a><a href="#name-proxy-and-intermediary-cons" class="section-name selfRef">Proxy and Intermediary Considerations</a>
        </h3>
<p id="section-14.8-1">Corporate proxies and other intermediaries <span class="bcp14">MAY</span> cache XET traffic.<a href="#section-14.8-1" class="pilcrow">¶</a></p>
<p id="section-14.8-2">Pre-signed URLs include authentication in the URL itself, allowing unauthenticated intermediaries to cache responses. However, reconstruction API requests include Bearer tokens in the <code>Authorization</code> header and <span class="bcp14">SHOULD NOT</span> be cached by intermediaries (the <code>private</code> directive prevents this).<a href="#section-14.8-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="content-integrity">
<section id="section-15.1">
        <h3 id="name-content-integrity">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-content-integrity" class="section-name selfRef">Content Integrity</a>
        </h3>
<p id="section-15.1-1">XET provides content integrity through cryptographic hashing:<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1-2.1">
            <p id="section-15.1-2.1.1">Chunk hashes verify individual chunk integrity<a href="#section-15.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-2.2">
            <p id="section-15.1-2.2.1">Xorb hashes verify complete xorb contents<a href="#section-15.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-2.3">
            <p id="section-15.1-2.3.1">File hashes verify complete file reconstruction<a href="#section-15.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-15.1-3">Implementations <span class="bcp14">SHOULD</span> verify hashes when possible, particularly for downloaded content.<a href="#section-15.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-and-authorization">
<section id="section-15.2">
        <h3 id="name-authentication-and-authoriz">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-authentication-and-authoriz" class="section-name selfRef">Authentication and Authorization</a>
        </h3>
<p id="section-15.2-1">Token-based authentication controls access to storage operations. Implementations <span class="bcp14">MUST</span>:<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.2-2.1">
            <p id="section-15.2-2.1.1">Transmit tokens only over TLS-protected connections<a href="#section-15.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-2.2">
            <p id="section-15.2-2.2.1">Avoid logging tokens<a href="#section-15.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-2.3">
            <p id="section-15.2-2.3.1">Implement token refresh before expiration<a href="#section-15.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-2.4">
            <p id="section-15.2-2.4.1">Use minimum required scope (prefer read over write)<a href="#section-15.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="global-deduplication-privacy">
<section id="section-15.3">
        <h3 id="name-global-deduplication-privac">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-global-deduplication-privac" class="section-name selfRef">Global Deduplication Privacy</a>
        </h3>
<p id="section-15.3-1">The keyed hash protection in global deduplication prevents enumeration attacks:<a href="#section-15.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.3-2.1">
            <p id="section-15.3-2.1.1">Servers never reveal raw chunk hashes<a href="#section-15.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.3-2.2">
            <p id="section-15.3-2.2.1">Clients can only match chunks they possess<a href="#section-15.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.3-2.3">
            <p id="section-15.3-2.3.1">The chunk hash key rotates periodically, and shard expiry limits the reuse window<a href="#section-15.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="denial-of-service-considerations">
<section id="section-15.4">
        <h3 id="name-denial-of-service-considera">
<a href="#section-15.4" class="section-number selfRef">15.4. </a><a href="#name-denial-of-service-considera" class="section-name selfRef">Denial of Service Considerations</a>
        </h3>
<p id="section-15.4-1">Large file uploads could exhaust server resources. Servers <span class="bcp14">SHOULD</span> implement:<a href="#section-15.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.4-2.1">
            <p id="section-15.4-2.1.1">Rate limiting on API endpoints<a href="#section-15.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.2">
            <p id="section-15.4-2.2.1">Maximum shard size limits (64 MiB)<a href="#section-15.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.4-2.3">
            <p id="section-15.4-2.3.1">Maximum xorb size limits (64 MiB)<a href="#section-15.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-16">
      <h2 id="name-iana-considerations">
<a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-16-1">This document does not require any IANA actions.<a href="#section-16-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-17">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-17.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BLAKE3">[BLAKE3]</dt>
        <dd>
<span class="refAuthor">Aumasson, J.</span>, <span class="refAuthor">Neves, S.</span>, <span class="refAuthor">O'Connor, J.</span>, and <span class="refAuthor">Z. Wilcox-O'Hearn</span>, <span class="refTitle">"BLAKE3: One function, fast everywhere"</span>, <time datetime="2020-01-09" class="refDate">9 January 2020</time>, <span>&lt;<a href="https://github.com/BLAKE3-team/BLAKE3-specs/blob/master/blake3.pdf">https://github.com/BLAKE3-team/BLAKE3-specs/blob/master/blake3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LZ4">[LZ4]</dt>
        <dd>
<span class="refAuthor">Collet, Y.</span>, <span class="refTitle">"LZ4 Frame Format Description"</span>, <time datetime="2015" class="refDate">2015</time>, <span>&lt;<a href="https://github.com/lz4/lz4/blob/dev/doc/lz4_Frame_format.md">https://github.com/lz4/lz4/blob/dev/doc/lz4_Frame_format.md</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-17.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="FASTCDC">[FASTCDC]</dt>
        <dd>
<span class="refAuthor">Feng, D.</span>, <span class="refAuthor">Hu, Y.</span>, <span class="refAuthor">Hua, Y.</span>, <span class="refAuthor">Jiang, H.</span>, <span class="refAuthor">Liu, Q.</span>, <span class="refAuthor">Xia, W.</span>, <span class="refAuthor">Zhang, Y.</span>, and <span class="refAuthor">Y. Zhou</span>, <span class="refTitle">"FastCDC: A Fast and Efficient Content-Defined Chunking Approach for Data Deduplication"</span>, <span class="seriesInfo">USENIX ATC 2016 </span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://www.usenix.org/conference/atc16/technical-sessions/presentation/xia">https://www.usenix.org/conference/atc16/technical-sessions/presentation/xia</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GEARHASH">[GEARHASH]</dt>
        <dd>
<span class="refAuthor">Rijsdijk, S.</span>, <span class="refTitle">"rust-gearhash: Fast, SIMD-accelerated GEAR hashing"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://github.com/srijs/rust-gearhash">https://github.com/srijs/rust-gearhash</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MERKLE">[MERKLE]</dt>
      <dd>
<span class="refAuthor">Merkle, R. C.</span>, <span class="refTitle">"A Digital Signature Based on a Conventional Encryption Function"</span>, <span class="seriesInfo">CRYPTO 1987, LNCS 293, pp. 369-378 </span>, <time datetime="1987" class="refDate">1987</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="gearhash-table">
<section id="appendix-A">
      <h2 id="name-gearhash-lookup-table">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-gearhash-lookup-table" class="section-name selfRef">Gearhash Lookup Table</a>
      </h2>
<p id="appendix-A-1">The <code>XET-GEARHASH-BLAKE3</code> content-defined chunking algorithm requires a lookup table of 256 64-bit constants. Implementations of this suite <span class="bcp14">MUST</span> use the exact values below for determinism.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-2">
<pre>
TABLE = [
    0xb088d3a9e840f559, 0x5652c7f739ed20d6, 0x45b28969898972ab, 0x6b0a89d5b68ec777,
    0x368f573e8b7a31b7, 0x1dc636dce936d94b, 0x207a4c4e5554d5b6, 0xa474b34628239acb,
    0x3b06a83e1ca3b912, 0x90e78d6c2f02baf7, 0xe1c92df7150d9a8a, 0x8e95053a1086d3ad,
    0x5a2ef4f1b83a0722, 0xa50fac949f807fae, 0x0e7303eb80d8d681, 0x99b07edc1570ad0f,
    0x689d2fb555fd3076, 0x00005082119ea468, 0xc4b08306a88fcc28, 0x3eb0678af6374afd,
    0xf19f87ab86ad7436, 0xf2129fbfbe6bc736, 0x481149575c98a4ed, 0x0000010695477bc5,
    0x1fba37801a9ceacc, 0x3bf06fd663a49b6d, 0x99687e9782e3874b, 0x79a10673aa50d8e3,
    0xe4accf9e6211f420, 0x2520e71f87579071, 0x2bd5d3fd781a8a9b, 0x00de4dcddd11c873,
    0xeaa9311c5a87392f, 0xdb748eb617bc40ff, 0xaf579a8df620bf6f, 0x86a6e5da1b09c2b1,
    0xcc2fc30ac322a12e, 0x355e2afec1f74267, 0x2d99c8f4c021a47b, 0xbade4b4a9404cfc3,
    0xf7b518721d707d69, 0x3286b6587bf32c20, 0x0000b68886af270c, 0xa115d6e4db8a9079,
    0x484f7e9c97b2e199, 0xccca7bb75713e301, 0xbf2584a62bb0f160, 0xade7e813625dbcc8,
    0x000070940d87955a, 0x8ae69108139e626f, 0xbd776ad72fde38a2, 0xfb6b001fc2fcc0cf,
    0xc7a474b8e67bc427, 0xbaf6f11610eb5d58, 0x09cb1f5b6de770d1, 0xb0b219e6977d4c47,
    0x00ccbc386ea7ad4a, 0xcc849d0adf973f01, 0x73a3ef7d016af770, 0xc807d2d386bdbdfe,
    0x7f2ac9966c791730, 0xd037a86bc6c504da, 0xf3f17c661eaa609d, 0xaca626b04daae687,
    0x755a99374f4a5b07, 0x90837ee65b2caede, 0x6ee8ad93fd560785, 0x0000d9e11053edd8,
    0x9e063bb2d21cdbd7, 0x07ab77f12a01d2b2, 0xec550255e6641b44, 0x78fb94a8449c14c6,
    0xc7510e1bc6c0f5f5, 0x0000320b36e4cae3, 0x827c33262c8b1a2d, 0x14675f0b48ea4144,
    0x267bd3a6498deceb, 0xf1916ff982f5035e, 0x86221b7ff434fb88, 0x9dbecee7386f49d8,
    0xea58f8cac80f8f4a, 0x008d198692fc64d8, 0x6d38704fbabf9a36, 0xe032cb07d1e7be4c,
    0x228d21f6ad450890, 0x635cb1bfc02589a5, 0x4620a1739ca2ce71, 0xa7e7dfe3aae5fb58,
    0x0c10ca932b3c0deb, 0x2727fee884afed7b, 0xa2df1c6df9e2ab1f, 0x4dcdd1ac0774f523,
    0x000070ffad33e24e, 0xa2ace87bc5977816, 0x9892275ab4286049, 0xc2861181ddf18959,
    0xbb9972a042483e19, 0xef70cd3766513078, 0x00000513abfc9864, 0xc058b61858c94083,
    0x09e850859725e0de, 0x9197fb3bf83e7d94, 0x7e1e626d12b64bce, 0x520c54507f7b57d1,
    0xbee1797174e22416, 0x6fd9ac3222e95587, 0x0023957c9adfbf3e, 0xa01c7d7e234bbe15,
    0xaba2c758b8a38cbb, 0x0d1fa0ceec3e2b30, 0x0bb6a58b7e60b991, 0x4333dd5b9fa26635,
    0xc2fd3b7d4001c1a3, 0xfb41802454731127, 0x65a56185a50d18cb, 0xf67a02bd8784b54f,
    0x696f11dd67e65063, 0x00002022fca814ab, 0x8cd6be912db9d852, 0x695189b6e9ae8a57,
    0xee9453b50ada0c28, 0xd8fc5ea91a78845e, 0xab86bf191a4aa767, 0x0000c6b5c86415e5,
    0x267310178e08a22e, 0xed2d101b078bca25, 0x3b41ed84b226a8fb, 0x13e622120f28dc06,
    0xa315f5ebfb706d26, 0x8816c34e3301bace, 0xe9395b9cbb71fdae, 0x002ce9202e721648,
    0x4283db1d2bb3c91c, 0xd77d461ad2b1a6a5, 0xe2ec17e46eeb866b, 0xb8e0be4039fbc47c,
    0xdea160c4d5299d04, 0x7eec86c8d28c3634, 0x2119ad129f98a399, 0xa6ccf46b61a283ef,
    0x2c52cedef658c617, 0x2db4871169acdd83, 0x0000f0d6f39ecbe9, 0x3dd5d8c98d2f9489,
    0x8a1872a22b01f584, 0xf282a4c40e7b3cf2, 0x8020ec2ccb1ba196, 0x6693b6e09e59e313,
    0x0000ce19cc7c83eb, 0x20cb5735f6479c3b, 0x762ebf3759d75a5b, 0x207bfe823d693975,
    0xd77dc112339cd9d5, 0x9ba7834284627d03, 0x217dc513e95f51e9, 0xb27b1a29fc5e7816,
    0x00d5cd9831bb662d, 0x71e39b806d75734c, 0x7e572af006fb1a23, 0xa2734f2f6ae91f85,
    0xbf82c6b5022cddf2, 0x5c3beac60761a0de, 0xcdc893bb47416998, 0x6d1085615c187e01,
    0x77f8ae30ac277c5d, 0x917c6b81122a2c91, 0x5b75b699add16967, 0x0000cf6ae79a069b,
    0xf3c40afa60de1104, 0x2063127aa59167c3, 0x621de62269d1894d, 0xd188ac1de62b4726,
    0x107036e2154b673c, 0x0000b85f28553a1d, 0xf2ef4e4c18236f3d, 0xd9d6de6611b9f602,
    0xa1fc7955fb47911c, 0xeb85fd032f298dbd, 0xbe27502fb3befae1, 0xe3034251c4cd661e,
    0x441364d354071836, 0x0082b36c75f2983e, 0xb145910316fa66f0, 0x021c069c9847caf7,
    0x2910dfc75a4b5221, 0x735b353e1c57a8b5, 0xce44312ce98ed96c, 0xbc942e4506bdfa65,
    0xf05086a71257941b, 0xfec3b215d351cead, 0x00ae1055e0144202, 0xf54b40846f42e454,
    0x00007fd9c8bcbcc8, 0xbfbd9ef317de9bfe, 0xa804302ff2854e12, 0x39ce4957a5e5d8d4,
    0xffb9e2a45637ba84, 0x55b9ad1d9ea0818b, 0x00008acbf319178a, 0x48e2bfc8d0fbfb38,
    0x8be39841e848b5e8, 0x0e2712160696a08b, 0xd51096e84b44242a, 0x1101ba176792e13a,
    0xc22e770f4531689d, 0x1689eff272bbc56c, 0x00a92a197f5650ec, 0xbc765990bda1784e,
    0xc61441e392fcb8ae, 0x07e13a2ced31e4a0, 0x92cbe984234e9d4d, 0x8f4ff572bb7d8ac5,
    0x0b9670c00b963bd0, 0x62955a581a03eb01, 0x645f83e5ea000254, 0x41fce516cd88f299,
    0xbbda9748da7a98cf, 0x0000aab2fe4845fa, 0x19761b069bf56555, 0x8b8f5e8343b6ad56,
    0x3e5d1cfd144821d9, 0xec5c1e2ca2b0cd8f, 0xfaf7e0fea7fbb57f, 0x000000d3ba12961b,
    0xda3f90178401b18e, 0x70ff906de33a5feb, 0x0527d5a7c06970e7, 0x22d8e773607c13e9,
    0xc9ab70df643c3bac, 0xeda4c6dc8abe12e3, 0xecef1f410033e78a, 0x0024c2b274ac72cb,
    0x06740d954fa900b4, 0x1d7a299b323d6304, 0xb3c37cb298cbead5, 0xc986e3c76178739b,
    0x9fabea364b46f58a, 0x6da214c5af85cc56, 0x17a43ed8b7a38f84, 0x6eccec511d9adbeb,
    0xf9cab30913335afb, 0x4a5e60c5f415eed2, 0x00006967503672b4, 0x9da51d121454bb87,
    0x84321e13b9bbc816, 0xfb3d6fb6ab2fdd8d, 0x60305eed8e160a8d, 0xcbbf4b14e9946ce8,
    0x00004f63381b10c3, 0x07d5b7816fcc4e10, 0xe5a536726a6a8155, 0x57afb23447a07fdd,
    0x18f346f7abc9d394, 0x636dc655d61ad33d, 0xcc8bab4939f7f3f6, 0x63c7a906c1dd187b
]
</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A-3">This table is from the <code>rust-gearhash</code> crate <span>[<a href="#GEARHASH" class="cite xref">GEARHASH</a>]</span>.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="test-vectors">
<section id="appendix-B">
      <h2 id="name-test-vectors">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-B-1">The following test vectors are for the <code>XET-GEARHASH-BLAKE3</code> algorithm suite.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="chunk-hash-test-vector">
<section id="appendix-B.1">
        <h3 id="name-chunk-hash-test-vector">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-chunk-hash-test-vector" class="section-name selfRef">Chunk Hash Test Vector</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.1-1">
<pre>
Input (ASCII): Hello World!
Input (hex): 48656c6c6f20576f726c6421

Hash (raw hex, bytes 0-31):
  a29cfb08e608d4d8726dd8659a90b9134b3240d5d8e42d5fcb28e2a6e763a3e8

Hash (XET string representation):
  d8d408e608fb9ca213b9909a65d86d725f2de4d8d540324be8a363e7a6e228cb
</pre><a href="#appendix-B.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="hash-string-conversion-test-vector">
<section id="appendix-B.2">
        <h3 id="name-hash-string-conversion-test">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-hash-string-conversion-test" class="section-name selfRef">Hash String Conversion Test Vector</a>
        </h3>
<p id="appendix-B.2-1">The XET hash string format interprets the 32-byte hash as four little-endian 64-bit unsigned values and prints each as 16 hexadecimal digits.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-2">
<pre>
Hash bytes [0..31]:
  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
  10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

Expected XET string:
  07060504030201000f0e0d0c0b0a090817161514131211101f1e1d1c1b1a1918
</pre><a href="#appendix-B.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-3">The conversion formula:<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-4">
<pre>
function hash_to_string(h):
    # h is a 32-byte array
    result = ""
    for i from 0 to 4:
        start = i * 8
        end = (i + 1) * 8
        u64_bytes = slice(h, start, end)
        u64_val = little_endian_to_u64(u64_bytes)
        result += format("{:016x}", u64_val)
    return result
</pre><a href="#appendix-B.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="internal-node-hash-test-vector">
<section id="appendix-B.3">
        <h3 id="name-internal-node-hash-test-vec">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-internal-node-hash-test-vec" class="section-name selfRef">Internal Node Hash Test Vector</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.3-1">
<pre>
Child 1:
  hash (XET string): c28f58387a60d4aa200c311cda7c7f77f686614864f5869eadebf765d0a14a69
  size: 100

Child 2:
  hash (XET string): 6e4e3263e073ce2c0e78cc770c361e2778db3b054b98ab65e277fc084fa70f22
  size: 200

Buffer being hashed (ASCII, with literal \n newlines):
  c28f58387a60d4aa200c311cda7c7f77f686614864f5869eadebf765d0a14a69 : 100\n
  6e4e3263e073ce2c0e78cc770c361e2778db3b054b98ab65e277fc084fa70f22 : 200\n

Result (XET string):
  be64c7003ccd3cf4357364750e04c9592b3c36705dee76a71590c011766b6c14
</pre><a href="#appendix-B.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="verification-range-hash-test-vector">
<section id="appendix-B.4">
        <h3 id="name-verification-range-hash-tes">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-verification-range-hash-tes" class="section-name selfRef">Verification Range Hash Test Vector</a>
        </h3>
<p id="appendix-B.4-1">Input: Two chunk hashes from test vector B.3, concatenated as raw bytes (not XET string format).<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.4-2">
<pre>
Chunk hash 1 (raw hex):
  aad4607a38588fc2777f7cda1c310c209e86f564486186f6694aa1d065f7ebad

Chunk hash 2 (raw hex):
  2cce73e063324e6e271e360c77cc780e65ab984b053bdb78220fa74f08fc77e2

Concatenated input (64 bytes, raw hex):
  aad4607a38588fc2777f7cda1c310c209e86f564486186f6694aa1d065f7ebad
  2cce73e063324e6e271e360c77cc780e65ab984b053bdb78220fa74f08fc77e2

Verification hash (XET string):
  eb06a8ad81d588ac05d1d9a079232d9c1e7d0b07232fa58091caa7bf333a2768
</pre><a href="#appendix-B.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="reference-files">
<section id="appendix-B.5">
        <h3 id="name-reference-files">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-reference-files" class="section-name selfRef">Reference Files</a>
        </h3>
<p id="appendix-B.5-1">Complete reference files including sample chunks, xorbs, and shards are available at:
https://huggingface.co/datasets/xet-team/xet-spec-reference-files<a href="#appendix-B.5-1" class="pilcrow">¶</a></p>
<p id="appendix-B.5-2">Key crates:<a href="#appendix-B.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.5-3.1">
            <p id="appendix-B.5-3.1.1"><code>cas_types</code>: Common type definitions<a href="#appendix-B.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-3.2">
            <p id="appendix-B.5-3.2.1"><code>cas_client</code>: CAS API client implementation<a href="#appendix-B.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-3.3">
            <p id="appendix-B.5-3.3.1"><code>mdb_shard</code>: Shard format serialization<a href="#appendix-B.5-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-3.4">
            <p id="appendix-B.5-3.4.1"><code>deduplication</code>: Chunking and deduplication logic<a href="#appendix-B.5-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-3.5">
            <p id="appendix-B.5-3.5.1"><code>merklehash</code>: Hash computation functions<a href="#appendix-B.5-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The XET protocol was invented by Hailey Johnson and Yucheng Low at Hugging Face. This specification is based on the reference implementation and documentation developed by the Hugging Face team.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Frank Denis</span></div>
<div dir="auto" class="left"><span class="org">Independent Contributor</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fde@00f.net" class="email">fde@00f.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
